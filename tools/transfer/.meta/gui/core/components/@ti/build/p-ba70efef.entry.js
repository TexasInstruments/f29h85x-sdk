import{r as t,c as e,h as i,g as s,a as o}from"./p-84e39b72.js";import{nullDataProvider as r}from"../gc-widget-grid/lib/NullDataProvider";import{GcConsole as n}from"../gc-core-assets/lib/GcConsole";import{DataConverter as h}from"../gc-core-databind/lib/CoreDatabind";import{GcUtils as c}from"../gc-core-assets/lib/GcUtils";import{W as l}from"./p-4352e6fe.js";import"./p-7b70dbb4.js";import"../gc-core-assets/lib/GcFiles";import"../gc-core-assets/lib/GcLocalStorage";import"../gc-widget-message-dialog/lib/GcMessageDialog";class a{constructor(){this.tos={};this._filterFn=p}push(t,e){this.tos={filteredRows:t,filterByText:e,next:this.tos}}pop(t,e,i=false){if(i||!e||t!==this.filterFn){this.tos={}}else{while(this.tos.next&&e.indexOf(this.tos.filterByText)<0){this.tos=this.tos.next}}this._filterFn=t;return this.tos.filteredRows}get filterByText(){return this.tos.filterByText}get filterFn(){return this._filterFn}}class d{constructor(t){this.dataProvider=t;this.isDisposed=false;this.selection=new Map;this.filterStack=new a;this.size=t.rowCount}get rowCount(){return this.filteredRows?this.filteredRows.length:this.size}getName(t){return""+(this.dataProvider.getValue(t,"name")||t)}dispose(){this.isDisposed=true}getRow(t,e){return new u(this,t,false,e)}getRelativePos(t){return t}parseRowFromPathSegment(t){const e=t.charAt(0);let i=-1;if(e<"0"||e>"9"){if(this.dataProvider.lookupRowByName){i=this.dataProvider.lookupRowByName(t)??-1}}else{i=+t}return i}findRowByPath(t,e=0,i){if(e!==t.length-1){return undefined}const s=this.parseRowFromPathSegment(t[e]);if(s>=0&&s<this.size){return new u(this,+s,true,i)}}isOpen(t){return false}setSelected(t,e){if(!e){this.selection.delete(t)}else{this.selection.set(t,true)}}isSelected(t){return this.selection.get(t)??false}sortAndFilter(t,e=false,i,s){if(!t){this.sortedRows=undefined}else{if(!this.sortedRows){this.sortedRows=new Array(this.size).fill(null).map(((t,e)=>e))}this.sortedRows=this.sortedRows.sort(((e,i)=>{if(this.dataProvider.isExpandable){const t=this.dataProvider.isExpandable(e)||false;const s=this.dataProvider.isExpandable(i)||false;if(t!==s){return t?-1:+1}}const s=this.dataProvider.getValue(e,t);const o=this.dataProvider.getValue(i,t);if(s>o){return+1}if(s<o){return-1}return e-i}));if(e){this.sortedRows=this.sortedRows.map(((t,e,i)=>i[i.length-1-e]))}}this.filter(i,s,true)}lookupVirtualRow(t){return this.filteredRows?this.filteredRows[t]??-1:t}lookupFilteredRow(t){return this.filteredRows?this.filteredRows.indexOf(t):t}filter(t,e,i=false){this.filteredRows=this.filterStack.pop(t,e,i)||this.sortedRows;if(e&&this.filterStack.filterByText!==e){if(!this.filteredRows){this.filteredRows=new Array(this.size).fill(null).map(((t,e)=>e))}this.filteredRows=this.filteredRows.filter((i=>this.filterRow(i,t,e)));this.filterStack.push(this.filteredRows,e)}}filterRow(t,e,i){return e(t,this.dataProvider,i,false)}saveExpandedStates(){return new Map}async restoreExpandedStates(t,e){return}isBusy(t){return false}isReadOnly(t,e){return this.dataProvider.isReadonly?.(t,e)||false}hasChildren(t){return false}setVisibility(t,e){if(this.dataProvider.setVisibility){if(!this.visible){this.visible=new Map}let i=this.visible.get(t)??0;i+=e?1:-1;if(i<=0){this.visible.delete(t)}else{this.visible.set(t,i)}if(e?i===1:i===0){this.dataProvider.setVisibility(t,e)}}}}class f extends d{constructor(t){super(t);this.dataProvider=t;this.sortDescending=false;this.children=new Array(this.size).fill(null).map(((t,e)=>({start:e,size:1,selected:false})));this.filteredChildren=this.children;this._rowCount=this.size}get rowCount(){return this._rowCount}collapse(t){const e=this.children[t];if(this.isDisposed||!e){return 0}if(e.expandingPromise){e.expandingCancelled=true}if(!e.node){return 0}e.expandedStates=e.node.saveExpandedStates();const i=e.node.rowCount;e.node.dispose();e.node=undefined;e.size=1;return-i}async expand(t,e,i,s){const o=this.children[t];if(this.isDisposed||o.node){return}if(o.expandingCancelled){o.expandingCancelled=false;if(o.expandingPromise){return o.expandingPromise}}const r=s||this.dataProvider.getChildDataProvider(t);if(r instanceof Promise){o.expandingPromise=r;e(0);s=await r;if(this.isDisposed){return}}else{s=r}let n=0;o.expandingPromise=undefined;if(o.expandingCancelled){o.expandingCancelled=false}else if(s){if(!s.isExpandable){o.node=new d(s)}else{o.node=new f(s)}o.node.sortAndFilter(this.sortByColumnName,this.sortDescending,this.filterStack.filterFn,this.filterStack.filterByText);n=o.node.rowCount}e(n);i=i||o.expandedStates;o.expandedStates=undefined;if(s&&i&&o.node instanceof f){await o.node.restoreExpandedStates((t=>{e(t)}),i)}}async expandAll(t,e=100){if(e>0){e=e-1;await Promise.all(this.filteredChildren.map((async(i,s)=>{if(this.isDisposed||i.node){return}const o=this.lookupVirtualRow(s);if(this.dataProvider.isExpandable(o)){i.expandedStates=undefined;const r=e=>{this.adjustSize(s,e);t(e)};await this.expand(o,r);if(i.node instanceof f){await i.node.expandAll(r,e)}}})))}}saveExpandedStates(){const t=super.saveExpandedStates();this.children.forEach(((e,i)=>{if(e.node){t.set(""+this.getName(i),e.node.saveExpandedStates())}}));return t}async restoreExpandedStates(t,e){if(e){await Promise.all(this.children.map((async(i,s)=>{if(this.isDisposed||i.node){return}const o=e.get(this.getName(s));if(o&&this.dataProvider.isExpandable(s)){await this.expand(s,(e=>{this.adjustSize(this.lookupFilteredRow(s),e);t(e)}),o)}})))}}isOpen(t){const e=this.children[t];return e.node!==undefined||e.expandingPromise!==undefined&&!e.expandingCancelled}dispose(){super.dispose();this.children.forEach((t=>{if(t.node){t.node.dispose()}}))}getChildIterator(t,e){const i=this.filteredChildren[t].node;if(i!==undefined&&i.rowCount>0){return new u(i,0,false,e)}return e.next(true)}adjustSize(t,e){if(e===0||t<0){return}this._rowCount+=e;this.filteredChildren[t].size=(this.filteredChildren[t].node?.rowCount??0)+1;for(let i=t+1;i<this.filteredChildren.length;i++){this.filteredChildren[i].start+=e}}findRowBinarySearch(t,e,i){const s=Math.round((t+e)/2);const o=this.filteredChildren[s];if(i<o.start){return this.findRowBinarySearch(t,s-1,i)}if(i>=o.start+o.size){return this.findRowBinarySearch(s+1,e,i)}return s}getRow(t,e){let i=0;let s=0;s=this.findRowBinarySearch(0,this.filteredChildren.length-1,t);const o=this.filteredChildren[s];i=o.start;const r=new u(this,s,false,e);return i===t?r:o.node.getRow(t-i-1,r)}getRelativePos(t){let e=0;for(let i=0;i<t;i++){e+=(this.filteredChildren[i].node?.rowCount??0)+1}return e}findRowByPath(t,e=0,i){if(e===t.length-1){return super.findRowByPath(t,e,i)}const s=this.parseRowFromPathSegment(t[e]);if(s>=0&&s<this.children.length&&this.children[s].node){return this.children[s].node.findRowByPath(t,e+1,new u(this,s,true,i))}}setSelected(t,e){const i=this.children[t];if(i){i.selected=e}}isSelected(t){const e=this.children[t];return e?e.selected:false}sortAndFilter(t,e=false,i,s){this.sortByColumnName=t;this.sortDescending=e;this.children.forEach((o=>o.node?.sortAndFilter(t,e,i,s)));super.sortAndFilter(t,e,i,s);this.reindex()}reindex(){this.filteredChildren=this.filteredRows?this.filteredRows.map(((t,e)=>this.children[this.lookupVirtualRow(e)])):this.children;let t=0;for(let e=0;e<this.filteredChildren.length;e++){const i=this.filteredChildren[e];i.start=t;i.size=(i.node?.rowCount??0)+1;t+=i.size}this._rowCount=t}filter(t,e,i=false){this.children.forEach((i=>i.node?.filter(t,e)));super.filter(t,e,i);this.reindex()}filterRow(t,e,i){const s=this.children[t];const o=(s.node?.rowCount??0)+1;return o>1||e(t,this.dataProvider,i,!!s.node)}isBusy(t){const e=this.children[t];return e.expandingPromise!==undefined&&!e.expandingCancelled}hasChildren(t){const e=this.children[t];return e.size>1}}class g{constructor(t,e){this.node=t;this.virtualRow=e;this.node.setVisibility(this.virtualRow,true)}clearVisibility(){this.node.setVisibility(this.virtualRow,false);return this}}class u{constructor(t,e=0,i=false,s){this.node=t;this.filteredRow=e;this.parent=s;this.dataProvider=t.dataProvider;this.indent=s?s.indent+1:0;if(i){this.virtualRow=e;this.filteredRow=this.node.lookupFilteredRow(e)}else{this.virtualRow=this.node.lookupVirtualRow(e)}}get hasChildren(){return this.node.hasChildren(this.virtualRow)}get path(){return(this.indent>0?`${this.parent.path}/`:"")+this.node.getName(this.virtualRow)}get pos(){const t=this.node.lookupFilteredRow(this.virtualRow);if(t<0){return t}return(this.indent>0?this.parent.pos+1:0)+this.node.getRelativePos(t)}next(t=false){if(!t&&this.node.isOpen(this.virtualRow)){return this.node.getChildIterator(this.filteredRow,this)}this.filteredRow++;this.virtualRow=this.node.lookupVirtualRow(this.filteredRow);if(this.virtualRow<this.node.size&&this.virtualRow>=0){return this}return this.parent?.next(true)}getValue(t){return this.dataProvider.getValue(this.virtualRow,t)}setValue(t,e){return this.dataProvider.setValue(this.virtualRow,t,e)}get isExpandable(){return this.dataProvider.isExpandable?.(this.virtualRow)}get rowIcon(){return this.dataProvider.getIconName?.(this.virtualRow,this.isOpen)||""}get isOpen(){return this.node.isOpen(this.virtualRow)}get isBusy(){return this.node.isBusy(this.virtualRow)}isReadOnly(t){return this.node.isReadOnly(this.virtualRow,t)}async open(t){if(this.isExpandable&&!this.isOpen){await this.node.expand(this.virtualRow,(e=>{this.adjustSize(e);t(e)}))}}close(){if(!this.isOpen){return 0}const t=this.node.collapse(this.virtualRow);this.adjustSize(t);return t}get selected(){return this.node.isSelected(this.virtualRow)}set selected(t){this.node.setSelected(this.virtualRow,t)}adjustSize(t){if(t===0){return}this.node.adjustSize(this.filteredRow,t);if(this.parent){this.parent.adjustSize(t)}}getPartName(t){return this.node.dataProvider.getPartName?.(this.virtualRow,t,{selected:this.selected})??""}setVisibility(){if(this.node.dataProvider.setVisibility){return new g(this.node,this.virtualRow)}}getSpan(t){return this.node.dataProvider.getSpan?.(this.virtualRow,t)||1}}const p=(t,e,i)=>{const s=""+e.getValue(t,"name");return s?.toLowerCase().includes(i.toLowerCase())??true};class v{constructor(t=r){this.root=new d(r);if(!t.isExpandable){this.root=new d(t)}else{this.root=new f(t)}}getRow(t){if(t>=0&&t<this.totalRowCount){return this.root.getRow(t)}}getRowByPath(t){return this.root.findRowByPath(t.split("/"))}setSelection(t){if(this.currentSelection){this.currentSelection.selected=false}this.currentSelection=t;if(this.currentSelection){this.currentSelection.selected=true}return this.currentSelection}get totalRowCount(){return this.root.rowCount}sortAndFilterBy(t,e=false,i=p,s){this.root.sortAndFilter(t,e,i,s)}filterBy(t=p,e){this.root.filter(t,e)}async expandAll(t,e=100){if(this.root instanceof f){await this.root.expandAll(t,e)}}saveExpandedStatesAndDispose(){const t=this.root.saveExpandedStates();this.root.dispose();return t}static create(t,e,i){const s=new v(e);s.root.restoreExpandedStates(t,i);return s}}const m=':host::-webkit-scrollbar,::-webkit-scrollbar{width:var(--gc-scrollbar-width, var(--theme-scrollbar-width, 8px));height:var(--gc-scrollbar-width, var(--theme-scrollbar-width, 8px))}:host::-webkit-scrollbar-track,::-webkit-scrollbar-track{background:var(--gc-scrollbar-track-background-color, var(--theme-scroll-track-color, rgba(35, 31, 32, 0.2)))}:host::-webkit-scrollbar-thumb,::-webkit-scrollbar-thumb{background:var(--gc-scrollbar-thumb-background-color, var(--theme-scroll-thumb-color, rgba(35, 31, 32, 0.65)))}:host::-webkit-scrollbar-thumb:hover,::-webkit-scrollbar-thumb:hover{background:var(--gc-scrollbar-thumb-background-color-hover, var(--theme-scroll-thumb-color-hover, rgba(35, 31, 32, 0.8)))}:host::-webkit-scrollbar-corner,::-webkit-scrollbar-corner{background:rgba(0, 0, 0, 0)}:host(:focus),:host *:focus{outline:none}:host{-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;font-family:var(--gc-font-family, var(--theme-font-family, "Roboto", "Open Sans", "Segoe UI", "Tahoma", "sans-serif"));font-size:var(--gc-font-size, var(--theme-font-size, 14px));font-weight:400;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));margin:var(--gc-margin, var(--theme-margin, 5px));display:inline-block;box-sizing:border-box}:host .user-select{-webkit-user-select:text;-khtml-user-select:text;-moz-user-select:text;-ms-user-select:text;-o-user-select:text;user-select:text}:host .text-link{color:var(--gc-link-color, var(--gc-link-color, var(--theme-link-color, #333333)));--gc-color:var(--gc-link-color, var(--gc-link-color, var(--theme-link-color, #333333)));--gc-text-decoration-hover:underline;--gc-cursor-hover:pointer}:host .text-link:not([disabled]):hover{text-decoration:underline;cursor:pointer}:host([hidden]){display:none !important}:host([readonly]) *{pointer-events:none}:host([disabled]) *{cursor:not-allowed}:host([caption]:not([caption=""])){margin-top:calc(var(--gc-margin, var(--theme-margin, 5px)) + var(--gc-caption-font-size, var(--theme-caption-font-size, 14px)) + 8px)}:host([caption]:not([caption=""])),:host([info-text]:not([info-text=""])){overflow:visible;position:relative}:host([caption=""][info-text]:not([info-text=""])),:host([info-text]:not([info-text=""]):not([caption])){margin-right:calc(var(--gc-margin, var(--theme-margin, 5px)) + 22px)}#elementWrapper{box-sizing:content-box;height:100%;width:100%;display:flex;align-items:center;min-height:inherit;max-height:inherit;min-width:inherit;max-width:inherit}.root-container{position:relative;display:flex;flex-direction:column;width:100%;height:100%;min-height:inherit;max-height:inherit;min-width:inherit;max-width:inherit}.root-container .header-container.top{top:var(--gc-header-container-top, calc(0px - 8px - var(--gc-caption-font-size, var(--theme-caption-font-size, 14px))));flex-direction:row}.root-container .header-container.side{right:-22px;flex-direction:column;height:inherit}.root-container .header-container{position:absolute;display:flex;align-items:center}.root-container .header-container .icon,.root-container .header-container gc-widget-icon{cursor:default;margin:auto;height:18px;width:18px;display:block;--gc-color:var(--gc-caption-info-color, var(--theme-caption-info-color, #98999b))}.root-container .header-container .caption{flex:1;cursor:default;white-space:nowrap;margin-right:2px;font-weight:var(--gc-caption-font-weight, var(--theme-caption-font-weight, 400));font-size:var(--gc-caption-font-size, var(--theme-caption-font-size, 14px));color:var(--gc-caption-font-color, var(--theme-caption-font-color, #999999))}.invisible{visibility:hidden}div.progress{border-color:var(--gc-progress-primary-color, var(--theme-secondary-color, #118899));border-bottom-color:var(--gc-progress-secondary-color, var(--gc-border-color, var(--theme-border-color, #e5e5e5)));border-style:solid;border-width:var(--gc-progress-thickness, 2px);border-radius:50%;width:var(--gc-progress-size, 14px);height:var(--gc-progress-size, 14px);animation:spin 0.8s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}:host::-webkit-scrollbar,::-webkit-scrollbar{width:var(--gc-scrollbar-width, var(--theme-scrollbar-width, 8px));height:var(--gc-scrollbar-width, var(--theme-scrollbar-width, 8px))}:host::-webkit-scrollbar-track,::-webkit-scrollbar-track{background:var(--gc-scrollbar-track-background-color, var(--theme-scroll-track-color, rgba(35, 31, 32, 0.2)))}:host::-webkit-scrollbar-thumb,::-webkit-scrollbar-thumb{background:var(--gc-scrollbar-thumb-background-color, var(--theme-scroll-thumb-color, rgba(35, 31, 32, 0.65)))}:host::-webkit-scrollbar-thumb:hover,::-webkit-scrollbar-thumb:hover{background:var(--gc-scrollbar-thumb-background-color-hover, var(--theme-scroll-thumb-color-hover, rgba(35, 31, 32, 0.8)))}:host::-webkit-scrollbar-corner,::-webkit-scrollbar-corner{background:rgba(0, 0, 0, 0)}:host(:focus),:host *:focus{outline:none}:host{-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;font-family:var(--gc-font-family, var(--theme-font-family, "Roboto", "Open Sans", "Segoe UI", "Tahoma", "sans-serif"));font-size:var(--gc-font-size, var(--theme-font-size, 14px));font-weight:400;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));margin:var(--gc-margin, var(--theme-margin, 5px));display:inline-block;box-sizing:border-box}:host .user-select{-webkit-user-select:text;-khtml-user-select:text;-moz-user-select:text;-ms-user-select:text;-o-user-select:text;user-select:text}:host .text-link{color:var(--gc-link-color, var(--gc-link-color, var(--theme-link-color, #333333)));--gc-color:var(--gc-link-color, var(--gc-link-color, var(--theme-link-color, #333333)));--gc-text-decoration-hover:underline;--gc-cursor-hover:pointer}:host .text-link:not([disabled]):hover{text-decoration:underline;cursor:pointer}:host([hidden]){display:none !important}:host([readonly]) *{pointer-events:none}:host([disabled]) *{cursor:not-allowed}:host([caption]:not([caption=""])){margin-top:calc(var(--gc-margin, var(--theme-margin, 5px)) + var(--gc-caption-font-size, var(--theme-caption-font-size, 14px)) + 8px)}:host([caption]:not([caption=""])),:host([info-text]:not([info-text=""])){overflow:visible;position:relative}:host([caption=""][info-text]:not([info-text=""])),:host([info-text]:not([info-text=""]):not([caption])){margin-right:calc(var(--gc-margin, var(--theme-margin, 5px)) + 22px)}#elementWrapper{box-sizing:content-box;height:100%;width:100%;display:flex;align-items:center;min-height:inherit;max-height:inherit;min-width:inherit;max-width:inherit}.root-container{position:relative;display:flex;flex-direction:column;width:100%;height:100%;min-height:inherit;max-height:inherit;min-width:inherit;max-width:inherit}.root-container .header-container.top{top:var(--gc-header-container-top, calc(0px - 8px - var(--gc-caption-font-size, var(--theme-caption-font-size, 14px))));flex-direction:row}.root-container .header-container.side{right:-22px;flex-direction:column;height:inherit}.root-container .header-container{position:absolute;display:flex;align-items:center}.root-container .header-container .icon,.root-container .header-container gc-widget-icon{cursor:default;margin:auto;height:18px;width:18px;display:block;--gc-color:var(--gc-caption-info-color, var(--theme-caption-info-color, #98999b))}.root-container .header-container .caption{flex:1;cursor:default;white-space:nowrap;margin-right:2px;font-weight:var(--gc-caption-font-weight, var(--theme-caption-font-weight, 400));font-size:var(--gc-caption-font-size, var(--theme-caption-font-size, 14px));color:var(--gc-caption-font-color, var(--theme-caption-font-color, #999999))}.invisible{visibility:hidden}:host{font-family:var(--gc-font-family, var(--theme-font-family, "Roboto", "Open Sans", "Segoe UI", "Tahoma", "sans-serif"));font-size:var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px)));font-weight:400;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));white-space:nowrap;border:2px solid var(--gc-border-color, var(--gc-border-color, var(--theme-border-color, #e5e5e5)));position:relative;line-height:var(--gc-row-height, calc(var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px))) + 10px))}:host([readonly]) *{pointer-events:auto !important}.grid{display:grid;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));background-color:var(--gc-background-color, var(--gc-background-color, var(--theme-background-color, #ffffff)));row-gap:0;column-gap:0;flex:1;overflow-x:auto;overflow-y:auto}.grid:not(.selectionDisabled) .grid-column:focus-within input[type=text][readonly],.grid:not(.selectionDisabled) .grid-column:focus-within .focused,.grid:not(.selectionDisabled) .grid-column:focus-within:not(.noOutline){outline:1px dotted var(--gc-outline-color-focus, var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555))));outline-offset:-3px}.grid.selectionDisabled .grid-row.selected input[type=text]:focus{border-color:transparent;background-color:transparent}.grid-row,.grid-content,.grid-header{display:contents}.grid-row[hidden],.grid-content[hidden],.grid-header[hidden]{display:none}.grid:not(.selectionDisabled) .grid-row:hover:not(.selected)>.grid-column{background-color:var(--gc-background-color-highlighted, var(--gc-background-color-highlighted, var(--theme-background-color-highlighted, #eeeeee)));color:var(--gc-font-color-highlighted, var(--gc-font-color-highlighted, var(--theme-font-color-highlighted, #555555)))}.grid-row.selected>.grid-column{background-color:var(--gc-background-color-selected-inactive, var(--gc-background-color-selected-inactive, var(--theme-background-color-selected-inactive, #e5e5e5)));color:var(--gc-font-color-selected-inactive, var(--gc-font-color-selected, var(--gc-font-color-selected, var(--theme-font-color-selected, #555555))))}.grid:focus-within .grid-row.selected>.grid-column{background-color:var(--gc-background-color-selected, var(--gc-background-color-selected, var(--theme-background-color-selected, #d9f1f4)));color:var(--gc-font-color-selected, var(--gc-font-color-selected, var(--theme-font-color-selected, #555555)))}.grid-column{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.grid-column.center{justify-content:center}.grid-column.end{justify-content:flex-end}.grid-column>*{padding:0px 5px 0px 5px}.container{display:flex;flex-direction:row;overflow:hidden;line-height:normal;position:relative;width:100%;height:100%}.grid-scrollbar{position:absolute;right:0px;top:0px;bottom:0px;outline:none;background-color:var(--gc-background-color, var(--gc-background-color, var(--theme-background-color, #ffffff)));overflow-y:scroll;overflow-x:hidden}.grid-scrollbar-content{width:1px}slot[name=columns]::slotted(*){--gc-color:var(--gc-heading-font-color, var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555))));border-color:var(--gc-background-color, var(--gc-background-color, var(--theme-background-color, #ffffff)));border-style:solid;border-width:1px 1px 0px 1px;--gc-font-color:var(--gc-heading-font-color);--gc-font-size:var(--gc-heading-font-size);--gc-font-weight:500;--gc-font-style:normal;z-index:1;}slot[name=columns]::slotted(*:first-child){border-width:1px 1px 0px 1px}input{font-family:var(--gc-font-family, var(--gc-font-family, var(--theme-font-family, "Roboto", "Open Sans", "Segoe UI", "Tahoma", "sans-serif")));font-size:var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px)));font-weight:400;margin:0px;width:100%;color:inherit;background-color:transparent;appearance:none;outline:none;border:2px solid transparent;box-sizing:border-box;vertical-align:middle}.grid-row.selected input[type=text]:focus{border:2px solid var(--gc-outline-color-focus, var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555))));background-color:var(--gc-background-color-input-focus, inherit);height:var(--gc-row-height, calc(var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px))) + 10px))}.grid-row.selected input[type=text]:focus.edit-mode{border-style:dashed}.grid-row.selected input[type=text]:focus[readonly]{border:2px solid transparent}.grid-row gc-widget-select{width:100%;height:var(--gc-row-height, calc(var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px))) + 10px));margin:0px;--gc-menuitem-background-color-selected:var(--gc-background-color-selected-inactive, var(--gc-background-color-selected-inactive, var(--theme-background-color-selected-inactive, #e5e5e5)));--gc-menuitem-color-selected:var(--gc-font-color-selected, var(--theme-font-color-selected, #555555))}.grid:focus-within .grid-row gc-widget-select{--gc-menuitem-background-color-selected:var(--gc-background-color-selected, var(--gc-background-color-selected, var(--theme-background-color-selected, #d9f1f4)))}input[type=checkbox]{height:18px;width:18px;appearance:none;border:2px solid var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));border-radius:4px;cursor:pointer;outline:none;transition:all 100ms cubic-blzier(0.4, 0, 0.2, 1);position:relative;margin:0px}input[type=checkbox].small{height:15px;width:15px;border-radius:3px}input[type=checkbox]:checked{box-sizing:border-box;background-color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)))}input[type=checkbox]:checked::after{box-sizing:border-box;position:absolute;display:block;top:1px;left:1px;width:12px;height:8px;content:" ";transform:rotate(-45deg);border-bottom:2px solid var(--gc-background-color, var(--gc-background-color, var(--theme-background-color, #ffffff)));border-left:2px solid var(--gc-background-color, var(--gc-background-color, var(--theme-background-color, #ffffff)))}input[type=checkbox]:checked.small::after{left:0px;width:10px;height:6px}@keyframes ckeckbox-focus-shadow{from{box-shadow:0 0 0 2px var(--gc-focus-color-highlight, var(--theme-focus-color-highlight, #9ed6df))}to{box-shadow:0 0 0 2px var(--gc-focus-color-highlight-25pct, var(--theme-focus-color-highlight-25pct, rgba(158, 214, 223, 0.25)))}}input[type=checkbox]:focus{animation:ckeckbox-focus-shadow linear 1s infinite alternate}.grid-row:hover input[type=checkbox]{border-color:var(--gc-font-color-highlighted, var(--gc-font-color-highlighted, var(--theme-font-color-highlighted, #555555)))}.grid-row:hover input[type=checkbox]:checked{background-color:var(--gc-font-color-highlighted, var(--gc-font-color-highlighted, var(--theme-font-color-highlighted, #555555)))}.grid-row:hover input[type=checkbox]:checked::after{border-bottom:2px solid var(--gc-background-color-highlighted, var(--gc-background-color-highlighted, var(--theme-background-color-highlighted, #eeeeee)));border-left:2px solid var(--gc-background-color-highlighted, var(--gc-background-color-highlighted, var(--theme-background-color-highlighted, #eeeeee)))}.grid-row.selected input[type=checkbox]{border-color:var(--gc-font-color-selected, var(--gc-font-color-selected, var(--theme-font-color-selected, #555555)))}.grid-row.selected input[type=checkbox]:checked{background-color:var(--gc-font-color-selected, var(--gc-font-color-selected, var(--theme-font-color-selected, #555555)))}.grid-row.selected input[type=checkbox]:checked::after{border-bottom:2px solid var(--gc-background-color-selected-inactive, var(--gc-background-color-selected-inactive, var(--theme-background-color-selected-inactive, #e5e5e5)));border-left:2px solid var(--gc-background-color-selected-inactive, var(--gc-background-color-selected-inactive, var(--theme-background-color-selected-inactive, #e5e5e5)))}.grid:focus-within .grid-row.selected input[type=checkbox]:checked::after{border-bottom:2px solid var(--gc-background-color-selected, var(--gc-background-color-selected, var(--theme-background-color-selected, #d9f1f4)));border-left:2px solid var(--gc-background-color-selected, var(--gc-background-color-selected, var(--theme-background-color-selected, #d9f1f4)))}.grid-row.selected:hover .icon.info,.grid-row.selected .icon:not(.tree):not(.info){fill:var(--gc-font-color-selected, var(--gc-font-color-selected, var(--theme-font-color-selected, #555555)))}.grid-row:hover .icon.info{fill:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)))}.grid-column:not(:focus-within) .hiddenWithoutFocus{display:none !important}.grid-column:focus-within .hiddenWithFocus{display:none !important}.icon{width:18px;height:18px;stroke-width:0;vertical-align:middle;fill:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));cursor:pointer}.icon.tree{fill:var(--gc-icon-color, var(--theme-secondary-color, #118899));margin-right:3px}.icon.info{fill:transparent;width:14px;height:14px;margin-left:5px}.icon.success-color{fill:#4caf50}.icon.error-color{fill:#dd0000}.icon.warning-color{fill:#ff9933}.icon.info-color{fill:#1e90ff}.icon.details-color{fill:#888888}.icon.grid{margin:1px}[readonly]{pointer-events:none}div.progress{margin-right:5px}.flex-row:not([hidden]){display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;width:100%;box-sizing:border-box}.flex-row:not([hidden])>*{flex-shrink:0;box-sizing:border-box}.flex-row:not([hidden])>*.flex{flex:1 1 3em}.flex-row:not([hidden])>label{overflow:hidden;text-overflow:ellipsis;line-height:100%;vertical-align:middle}';const b=["one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve"].reduce(((t,e,i)=>{t.set(e,i);return t}),new Map);let x=class{constructor(i){t(this,i);this.viewportChanged=e(this,"viewport-changed",7);this.selectedRowChanged=e(this,"selected-row-changed",7);this.selectedPathChanged=e(this,"selected-path-changed",7);this.cssPropertyChanged=e(this,"css-property-changed",7);this.treeStates=new v;this.startRow=0;this.nVisibleRows=0;this.pageSize=1;this.pageHeight=1;this.activeSelectedRow=-1;this.activeSelectedColumn=-1;this.rowHeight=24;this.columnHeadings=[];this.savedExpandedStatesMap=new Map;this.activeDataProviderId="";this.currentVisibleRows=[];this.viewportInfo={startRow:0,visibleRows:0};this.isScrolling=false;this.whenScrollingStartRowOffset=0;this.headerHeight=0;this.keepSelectedRowVisible=true;this.isScrollBarShowing=false;this.cellEditorEnabled=false;this.lastScrollTop=0;this.totalRows=0;this.columns=[];this.updateTotalRowCount=t=>{const e=this.treeStates.totalRowCount;if(this.totalRows!==e){this.totalRows=e;if(this.activeSelection){this.selectedRow=this.activeSelection.pos}this.logger.debug((()=>`Total number of rows changed to ${e}`))}else if(t===0){this.refresh()}};this.virtual=false;this.smoothScrolling=false;this.sortDescending=false;this.selectedRow=-1;this.selectedPath="";this.hideHeading=false;this.disableSelection=false;this.preventScroll=t=>{t.preventDefault();t.stopPropagation();this.scrollViewport(this.scrollTop)};this.doRepositionScrollThumb=()=>{this.repositionScrollThumbTimer=undefined;if(this.isScrolling||this.whenScrollingStartRowOffset===0){return}const t=this.whenScrollingStartRowOffset;this.whenScrollingStartRowOffset=0;this.logger.debug((()=>`Repositioning scroll thumb by ${t} rows`));this.scrollTop+=t*this.rowHeight};this.onScroll=()=>{const t=this.scrollTop;if(this.virtual){if(this.lastScrollTop!==t){if(this.el.shadowRoot.querySelector(".grid-focusable:focus-within")){this.saveActiveEditorSelectionState()}this.lastScrollTop=t}}else{this.scrollViewport(t)}if(this.repositionScrollThumbTimer!==undefined){this.stopRepositionScrollThumbTimer();this.startRepositionScrollThumbTimer()}this.updateViewportInfo("onScroll")};this.onSelectHandler=t=>{const e=t.currentTarget;const i=e.id;const s=i.split(",");if(s.length===2){const t=+s[0];const i=+s[1];const o=i+this.getColumnSpan(e);this.logger.debug((()=>`onSelectHandler: click on cell x=${i} y=${t}`));if(t!==this.activeSelectedRow||this.activeSelectedColumn<i||this.activeSelectedColumn>=o){this.activeSelection=this.treeStates.setSelection(this.treeStates.getRow(t+this.startRow));this.activeSelectedColumn=i;this.selectedRow=this.activeSelection?.pos??-1;this.selectedPath=this.activeSelection?.path??"";this.setFocusAfterRender={selectAll:false,hint:"click"};this.cellEditorEnabled=true}else if(!this.cellEditorEnabled){this.setFocusAfterRender={selectAll:false,hint:"click"};this.cellEditorEnabled=true}}};this.setFocusOnActiveEditor=()=>{if(this.cellEditorEnabled&&this.hasSelection){const t=this.gridContent.children[this.activeSelectedRow];const e=this.getIndexOfActiveColumn(t?.children,this.activeSelectedColumn);const i=t?.children[e];const s=i.querySelector("*:focus-within");const o=i?.firstElementChild;if(o&&!i.classList.contains("noFocus")&&!s){const t=this.columns[e];this.logger.debug((()=>`setFocusOnActiveEditor: focus redirected to editor x=${e} y=${this.activeSelectedRow}`));o.focus({preventScroll:true});let i={selectAll:false,hint:""};if(this.editorSelectionState?.path===this.selectedPath&&this.editorSelectionState.column===e){i={selectAll:false,selectionState:this.editorSelectionState.selectionState,hint:""};this.editorSelectionState=undefined}t.restoreEditorSelectionState?.(o,this.setFocusAfterRender||i)}}};this.setFocusOnCell=()=>{if(this.hasSelection){const t=this.gridContent.children[this.activeSelectedRow];const e=this.getIndexOfActiveColumn(t?.children,this.activeSelectedColumn);const i=t?.children[e];if(i){this.logger.debug((()=>`setFocusOnCell: focus redirected to cell x=${e} y=${this.activeSelectedRow}`));i.focus({preventScroll:true})}}};this.setFocusOnGrid=()=>{if(this.hasSelection){const t=this.gridContent.children[this.activeSelectedRow];const e=this.getIndexOfActiveColumn(t?.children,this.activeSelectedColumn);const i=t?.children[e];const s=i?.firstElementChild;if(this.cellEditorEnabled&&s&&!i.classList.contains("noFocus")){this.setFocusOnActiveEditor()}else{this.setFocusOnCell()}}else{this.logger.debug((()=>"setFocusOnGrid: focus set on grid"));this.scrollContainer?.focus({preventScroll:true})}};this.onMousewheelHandler=t=>{if(this.isScrollBarShowing&&t.deltaY){t.preventDefault();this.scrollContainer.scrollBy(0,t.deltaY)}};this.onKeyHandler=t=>{switch(t.key){case"End":if(t.ctrlKey){this.moveToCell(t,this.totalRows)}else if(this.isScrollLock(t)){this.scrollToColumn(t,1,true)}else{this.moveToCell(t,0,this.gotoNextVisibleColumn(this.columns.length,-1))}break;case"Home":if(t.ctrlKey){this.moveToCell(t,-this.totalRows)}else if(this.isScrollLock(t)){this.scrollToColumn(t,-1,true)}else{this.moveToCell(t,0,this.gotoNextVisibleColumn(-1,+1))}break;case"PageUp":this.moveToCell(t,-this.pageSize);break;case"PageDown":this.moveToCell(t,+this.pageSize);break;case"ArrowUp":this.moveToCell(t,-1);break;case"ArrowDown":this.moveToCell(t,+1);break;case"ArrowLeft":if(this.isScrollLock(t)){this.scrollToColumn(t,-1)}else{this.moveToCell(t,0,this.gotoNextVisibleColumn(this.activeSelectedColumn,-1))}break;case"ArrowRight":if(this.isScrollLock(t)){this.scrollToColumn(t,1)}else{this.moveToCell(t,0,this.gotoNextVisibleColumn(this.activeSelectedColumn,+1))}break;case" ":t.preventDefault();break;case"Escape":if(this.cellEditorEnabled){this.cellEditorEnabled=false;this.setFocusAfterRender={selectAll:false,hint:t.key}}t.preventDefault();break;case"F2":if(!this.cellEditorEnabled){this.setFocusAfterRender={selectAll:true,hint:t.key};this.cellEditorEnabled=true}break}};this.onScrollingStarted=()=>{this.isScrolling=true};this.onScrollingFinished=()=>{this.isScrolling=false;this.startRepositionScrollThumbTimer()};this.onCSSPropertyChanged=()=>{const t=this.rowHeight;const e=this.scrollTop;this.updateRowHeight();let i=Math.round(e*(this.rowHeight/t-1));if(i!==0){if(i>0){const t=Math.ceil(i/this.rowHeight);i-=t*this.rowHeight;this.scrollTop=e+i;this.scrollRowsBy(t,false)}else{this.scrollTop=e+i}}this.refresh()};this._refresh=0;this.hidden=false;this.readonly=false}updateRowHeight(){const t=parseInt(getComputedStyle(this.el).getPropertyValue("line-height").trim());if(!isNaN(t)){this.rowHeight=t||1}}updateViewportInfo(t){const e=(this.grid||this.el)?.clientHeight||0;const i=Math.floor((e-this.headerHeight)/this.rowHeight);const s=this.scrollTop;const o=Math.floor(s/this.rowHeight)+this.whenScrollingStartRowOffset;if(o!==this.viewportInfo.startRow||i!==this.viewportInfo.visibleRows){this.viewportInfo.startRow=o;this.viewportInfo.visibleRows=i;this.viewportChanged.emit({...this.viewportInfo,reason:t})}}get scrollTop(){return Math.round(this.scrollContainer?.scrollTop??0)}set scrollTop(t){if(!this.scrollContainer){return}t=Math.max(t,0);t=Math.min(t,this.scrollContainer.scrollHeight-this.scrollContainer.clientHeight);this.scrollContainer.scrollTo(0,t);const e=Math.round(t-this.scrollContainer.scrollTop);if(e!==0){this.scrollContainer.scrollBy(0,e);if(this.scrollTop===t){this.logger.warning((()=>`scrollTop has fractional error due to Chrome bug.  Added ${e} to scrollTop to compensate.`))}else{this.logger.error((()=>`scrollTop has fractional error due to Chrome bug, Adding ${e} to scrollTop did not work.`))}}}onSortByColumnChanged(){this.treeStates.sortAndFilterBy(this.sortByColumn,this.sortDescending,this.filterFn,this.filterText);this.updateTotalRowCount()}onFilterTextChanged(){this.treeStates.filterBy(this.filterFn,this.filterText);this.updateTotalRowCount()}onSelectedRowChanged(){const t=this.activeSelection?.pos??-1;if(t!==this.selectedRow){this.activeSelection=this.treeStates.setSelection(this.treeStates.getRow(this.selectedRow));this.selectedPath=this.activeSelection?.path??""}if(this.selectedRow>=0&&this.keepSelectedRowVisible){let t;let e;const i=this.scrollTop+this.whenScrollingStartRowOffset*this.rowHeight;if(this.smoothScrolling){e=this.selectedRow*this.rowHeight-i;t=this.pageHeight-this.rowHeight}else{e=(this.selectedRow-Math.max(0,Math.floor(i/this.rowHeight)))*this.rowHeight;t=this.pageSize*this.rowHeight}if(e<0){this.scrollTop+=e-(this.smoothScrolling?0:i%this.rowHeight)}else if(e>t){this.scrollTop+=e-t-(this.smoothScrolling?0:i%this.rowHeight)}}this.selectedRowChanged.emit({value:this.selectedRow})}onSelectedPathChanged(){const t=this.activeSelection?.path??"";const e=this.selectedPath??"";if(t!==e){this.activeSelection=this.treeStates.setSelection(this.treeStates.getRowByPath(e));this.selectedRow=this.activeSelection?.pos??-1}this.selectedPathChanged.emit({value:this.selectedPath})}onVirtualChanged(){if(this.virtual){this.lastScrollTop=this.scrollTop}}async setDataProvider(t,e=0,i=""){const s=this.selectedPath;if(this.scrollContainer?.firstElementChild){this.scrollContainer.firstElementChild.style.height="0px"}this.savedExpandedStatesMap.set(this.activeDataProviderId,this.treeStates.saveExpandedStatesAndDispose());this.activeDataProviderId=i;this.treeStates=v.create(this.updateTotalRowCount,t,this.savedExpandedStatesMap.get(this.activeDataProviderId));if(this.sortByColumn){this.treeStates.sortAndFilterBy(this.sortByColumn,this.sortDescending,this.filterFn,this.filterText)}else if(this.filterText){this.treeStates.filterBy(this.filterFn,this.filterText)}this.updateTotalRowCount();await this.expandToLevel(e);this.selectedPath=s;this.updateRowHeight();this.updateViewportInfo("setDataProvider");this.refresh()}async scrollRowsBy(t,e=true){if(t===0){return}this.logger.debug((()=>`scrollRowsBy = ${t}, selectedRow = ${this.selectedRow}, this.whenScrollingStartRowOffset = ${this.whenScrollingStartRowOffset}`));this.whenScrollingStartRowOffset+=t;this.startRepositionScrollThumbTimer();if(this.selectedRow>=0&&e){this.keepSelectedRowVisible=false;try{let e=this.selectedRow+t;if(e<0||e>this.totalRows){e=-1}this.selectedRow=e}finally{this.keepSelectedRowVisible=true}}this.updateViewportInfo("scrollRowsBy");this.refresh()}expandToLevel(t){return this.treeStates.expandAll(this.updateTotalRowCount,t)}async setFilterMethod(t){this.filterFn=t;if(this.filterText){this.treeStates.filterBy(this.filterFn,this.filterText);this.updateTotalRowCount()}}startRepositionScrollThumbTimer(){if(this.isScrolling||this.repositionScrollThumbTimer){return}this.repositionScrollThumbTimer=setTimeout(this.doRepositionScrollThumb,100)}stopRepositionScrollThumbTimer(){if(this.repositionScrollThumbTimer!==undefined){clearTimeout(this.repositionScrollThumbTimer)}this.repositionScrollThumbTimer=undefined}get hasSelection(){return this.activeSelectedRow>=0&&this.activeSelectedColumn>=0&&!this.disableSelection}getColumnSpan(t){const e=t.style["grid-column-end"];if(e?.startsWith("span ")){return Number(e.substring("span ".length))}return 1}getIndexOfActiveColumn(t,e){if(!t||e<0){return e}let i=0;let s=0;for(;s<t.length;s++){const o=i;i=o+this.getColumnSpan(t[s]);if(e>=o&&e<i){break}}return s}forceActiveEditorToCommitChanges(){if(this.cellEditorEnabled){this.cellEditorEnabled=false;this.setFocusOnCell();this.cellEditorEnabled=true}}saveActiveEditorSelectionState(){if(this.disableSelection){this.setFocus()}else if(this.cellEditorEnabled){const t=this.gridContent.children[this.activeSelectedRow];const e=this.getIndexOfActiveColumn(t?.children,this.activeSelectedColumn);const i=this.columns[e];if(i?.saveEditorSelectionState){const i=t?.children[e].firstElementChild;if(i){this.editorSelectionState={path:this.selectedPath,column:e,selectionState:this.columns[e].saveEditorSelectionState?.(i)}}}this.forceActiveEditorToCommitChanges()}}isColumnVisible(t){const e=this.columnHeadings[t];return e&&!(e.hidden||e.minimized)}gotoNextVisibleColumn(t,e){do{t=t+e;if(t<0||t>=this.columns.length||isNaN(t)){return this.activeSelectedColumn}}while(!this.isColumnVisible(t));return t}isScrollLock(t){return this.selectedRow<0||this.disableSelection||t.getModifierState("ScrollLock")}moveToCell(t,e=0,i){if(this.isScrollLock(t)&&e!==0){this.scrollTop+=e*this.rowHeight-(this.smoothScrolling?0:this.scrollTop%this.rowHeight);if(this.disableSelection){this.setFocusAfterRender={selectAll:false,hint:t.key}}}else if(this.selectedRow>=0){let s=e+this.selectedRow;const o=Math.abs(this.whenScrollingStartRowOffset);s=Math.max(s,o);s=Math.min(s,(this.totalRows||0)-1-o);if(s!==this.selectedRow||i!==this.activeSelectedColumn&&i!==undefined){this.logger.debug((()=>`moveToCell after key ${t.key} pressed.  Removing focus on active editor at x=${this.activeSelectedColumn} y=${this.activeSelectedRow}`));this.forceActiveEditorToCommitChanges();if(i!==undefined){this.activeSelectedColumn=i}this.cellEditorEnabled=true;this.setFocusAfterRender={selectAll:true,hint:t.key};this.activeSelection=this.treeStates.setSelection(this.treeStates.getRow(s));this.selectedRow=this.activeSelection?.pos??-1;this.selectedPath=this.activeSelection?.path??""}if(i!==undefined){const t=this.gridContent.children[s-this.startRow];const e=this.getIndexOfActiveColumn(t?.children,i);const o=t?.children[e];if(o){this.scrollIntoViewHorizontally(o)}}}t.preventDefault();t.stopPropagation()}scrollToColumn(t,e,i=false){let s;const o=this.grid.scrollLeft;const r=this.grid.clientWidth;const n=Math.min(15,r/4);if(!i){let t;s=this.gridContent.firstElementChild.firstElementChild;while(s&&(e<0?s.offsetLeft<o-n:s.offsetLeft<o+n)){t=s;s=s.nextElementSibling}if(e<0){s=t}}if(s){const t=s.offsetLeft-o;this.grid.scrollBy(e<0?Math.max(-r,t):Math.min(r,t),0)}else{this.grid.scrollBy(e<0?-this.grid.scrollWidth:this.grid.scrollWidth,0)}t.preventDefault();t.stopPropagation()}calculateVisibleRowCount(t){const e=Math.ceil(t/this.rowHeight);return Math.min(this.totalRows,e)}calculateStartRowAndScrollTop(t,e=0){let i=Math.max(0,Math.floor(e/this.rowHeight)+this.whenScrollingStartRowOffset);let s=this.smoothScrolling?e%this.rowHeight:0;const o=i+t-this.totalRows;if(o>0){s+=o*this.rowHeight;i-=o}return[i,s]}getGridColumnWidths(){const t=this.columnHeadings.map(((t,e)=>{if(t.hidden===true){return"0px"}if(t.minimized===true){return"min-content"}const i=getComputedStyle(t).getPropertyValue("--gc-column-width");if(i){return i}if(t.hasAttribute("flex")){return(getComputedStyle(t).getPropertyValue("flex-grow")||"1")+"fr"}if(t.style.width){return t.style.width}return"min-content"}));return t.join(" ")}renderRows(t,e){this.activeSelectedRow=-1;const s=this.currentVisibleRows;this.currentVisibleRows=[];let o=this.treeStates.getRow(t);const r=new Array(e).fill(null).map(((t,e)=>{try{const t=o.setVisibility();if(t){this.currentVisibleRows.push(t)}const s=o.selected;const r=s?!this.disableSelection&&this.activeSelectedColumn:-1;const n=this.cellEditorEnabled?r:-1;if(s){this.activeSelectedRow=e}let h=1;const c=this.columns.map(((t,c)=>{if(h>1){h--;return null}h=t.getSpan?.(e,o)??1;if(h<0){h=this.columns.length-c}const l=n>=c&&n<c+h;const{element:a,focusable:d}=t.renderCell(e,o,s,l,l?0:-1);const f=`grid-column ${t.align||"start"}${this.cellEditorEnabled&&d?t.hideFocusRectangle?" noOutline":"":" noFocus"}`;return i("div",{class:f,key:`${c}`,id:`${e},${c}`,tabIndex:(!this.cellEditorEnabled||!d)&&r===c?0:-1,onFocus:this.disableSelection?this.setFocus:this.setFocusOnActiveEditor,onMouseDown:this.disableSelection?null:this.onSelectHandler,style:h>1?{"grid-column-end":`span ${h}`}:{}},a)}));return i("div",{class:`grid-row${s?" selected":""}`,key:e,id:`${e}`},c)}catch(t){return i("div",null,t.message||t.toString())}finally{o=o.next()}}));s.forEach((t=>t.clearVisibility()));return r}render(){this.updateRowHeight();const t=(this.grid||this.el).clientHeight;this.nVisibleRows=this.virtual?this.calculateVisibleRowCount(t):this.totalRows;this.startRow=this.calculateStartRowAndScrollTop(this.nVisibleRows,this.scrollTop)[0];const e=this.getGridColumnWidths();return i("div",{key:"container",class:"container"},i("template",null,i("slot",null)),i("div",{key:"grid",class:`grid${this.disableSelection?" selectionDisabled":""}`,ref:t=>this.grid=t,onKeyDown:this.onKeyHandler,onWheel:this.onMousewheelHandler,onScroll:this.preventScroll,style:{"grid-template-rows":`${this.hideHeading?"":"min-content "}repeat(${this.nVisibleRows||1}, ${this.rowHeight}px)`,"grid-template-columns":`${e}`}},i("div",{key:"grid-header",class:"grid-header",hidden:this.hideHeading},i("slot",{name:"columns"})),i("div",{key:"grid-content",class:"grid-content grid-focusable",ref:t=>this.gridContent=t,tabIndex:-1},this.renderRows(this.startRow,this.nVisibleRows)),i("div",{key:"grid-padding",class:"grid-padding",style:{height:`${this.smoothScrolling?0:this.rowHeight}px`}})),i("div",{key:"grid-scrollbar",tabIndex:this.hasSelection?-1:0,class:"grid-scrollbar grid-focusable",onMouseDown:this.onScrollingStarted,onMouseUp:this.onScrollingFinished,onKeyDown:this.onKeyHandler,onFocus:this.disableSelection?null:this.setFocusOnCell,ref:t=>this.scrollContainer=t,onScroll:this.onScroll},i("div",{key:"grid-scrollbar-content",class:"grid-scrollbar-content"})))}setupScrollbar(){const t=this.el.children;this.headerHeight=0;if(!this.hideHeading){this.headerHeight=this.rowHeight;for(let e=0;e<t.length;e++){this.headerHeight=Math.max(this.headerHeight,t[e].offsetHeight)}}this.pageHeight=this.grid.clientHeight-this.headerHeight;this.pageSize=Math.max(Math.floor(this.pageHeight/this.rowHeight),2)-1;const e=this.totalRows*this.rowHeight;this.isScrollBarShowing=e>this.pageHeight;if(this.isScrollBarShowing){this.scrollContainer.firstElementChild.style.height=`${this.headerHeight+e+(this.smoothScrolling?0:this.rowHeight)}px`;if(this.grid.offsetHeight>this.grid.clientHeight){this.scrollContainer.style.overflowX="scroll"}else{this.scrollContainer.style.overflowX=""}if(this.scrollContainer.clientWidth!==0){this.scrollContainer.style.width=`${this.scrollContainer.offsetWidth-this.scrollContainer.clientWidth}px`}}this.scrollContainer.style.display=this.isScrollBarShowing?"":"none";this.grid.style.overflowY=this.isScrollBarShowing?"scroll":"hidden"}scrollViewport(t){if(this.columns.length>0){const e=this.calculateStartRowAndScrollTop(this.nVisibleRows,t)[1];this.grid.scrollTop=e;const i=Math.round(e-this.grid.scrollTop);if(i){this.logger.warning((()=>`scrollTop has fractional error due to Chrome bug.  Adding ${i} to scrollTop to compensate.`));this.grid.scrollBy(0,i)}}}componentDidRender(){this.setupScrollbar();this.scrollViewport(this.scrollTop);this.logger.debug((()=>`Component did render at x=${this.activeSelectedColumn} y=${this.activeSelectedRow}`));if(this.setFocusAfterRender||this.el.shadowRoot.querySelector(".grid-focusable:focus-within")){this.setFocusOnGrid()}this.setFocusAfterRender=undefined}async toggleOpen(t){const e=this.treeStates.getRow(t+this.startRow);if(e&&!e.isBusy){if(e.isOpen){this.updateTotalRowCount(e.close())}else{await e.open(this.updateTotalRowCount)}}}redraw(t=-1){if(t<0||this.startRow<=t&&t<=this.startRow+this.nVisibleRows){this.refresh()}}commitEditValueChange(t,e,i){const s=t<0?this.activeSelection:this.treeStates.getRow(t+this.startRow);if(s){s.setValue(e,i);this.redraw(t+this.startRow)}}getCommittedEditValue(t,e){const i=t<0?this.activeSelection:this.treeStates.getRow(t+this.startRow);if(i){return i.getValue(e)}}async setFocus(){this.cellEditorEnabled=false;this.setFocusOnGrid()}get visibleRowCount(){return this.virtual?this.nVisibleRows:this.pageSize}scrollIntoViewHorizontally(t){const e=this.grid.getBoundingClientRect();const i=this.scrollContainer.getBoundingClientRect();const s=t.getBoundingClientRect();const o=e.left-s.left;const r=s.right-e.right+i.width;if(o>0&&r<0){this.grid.scrollBy(-Math.min(o,-r),0)}else if(o<0&&r>0){this.grid.scrollBy(Math.min(-o,r),0)}}async updateColumnHeadings(){this.editorSelectionState=undefined;const t=this.el.children;const e=[];this.columnHeadings=[];for(let i=0;i<t.length;++i){const s=t[i];if(s.createCellRenderer){this.columnHeadings.push(s);s.setAttribute("slot","columns");e.push(t[i].createCellRenderer(this));s.style.setProperty("z-index",`${t.length-i}`)}}this.columns=await Promise.all(e)}connectedCallback(){this.logger=new n("gc-widget-grid",this.el.id);this.updateColumnHeadings();this.resizeObserver=new ResizeObserver((()=>{this.updateViewportInfo("resize");this.refresh()}));this.resizeObserver.observe(this.el);this.childObserver=new MutationObserver((t=>{t.forEach((t=>{if(t.type==="childList"&&t.target===this.el){this.updateColumnHeadings()}else if(t.type==="attributes"&&t.target!==this.el&&b.has(t.attributeName)){this.refresh()}}))}));this.childObserver.observe(this.el,{attributes:true,childList:true,subtree:true});this.el.addEventListener("css-property-changed",this.onCSSPropertyChanged)}disconnectedCallBack(){this.resizeObserver.disconnect();this.childObserver.disconnect();this.el.removeEventListener("css-property-changed",this.onCSSPropertyChanged)}async setCSSProperty(t,e){e=e.trim();if(await this.getCSSProperty(t)!==e){this.el.style.setProperty(t,e);this.cssPropertyChanged.emit({name:t,value:e})}}async getCSSProperty(t){return getComputedStyle(this.el).getPropertyValue(t).trim()}async refresh(){this._refresh++}get el(){return s(this)}static get watchers(){return{sortByColumn:["onSortByColumnChanged"],sortDescending:["onSortByColumnChanged"],filterText:["onFilterTextChanged"],selectedRow:["onSelectedRowChanged"],selectedPath:["onSelectedPathChanged"],virtual:["onVirtualChanged"]}}};x.style=m;const w=":host{background-color:var(--gc-heading-color, var(--gc-border-color, var(--theme-border-color, #e5e5e5)));font-weight:var(--gc-font-weight, 500);font-size:var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px)));font-style:var(--gc-font-style, normal);white-space:nowrap;margin:0px;position:sticky;top:0%;text-align:var(--gc-heading-text-align, center);width:100%;align-self:stretch;box-sizing:border-box}:host(:focus),:host *:focus{outline:none}.header-container{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:center;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)))}.header-container>*:not(.stretch){flex-shrink:0}.stretch{flex:1}label,gc-widget-label{overflow:hidden;text-overflow:ellipsis;padding:5px 5px 5px 5px}slot::slotted(*:focus),.action:focus{outline:1px dotted var(--gc-focus-color, var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555))));outline-offset:1px}.action{--gc-color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));cursor:pointer}";const k="edit-mode";class y{constructor(t,e){this.params=t;this.callback=e;this.editMode=false;this.onCheckboxKeyHandler=t=>{if(t.key===" "||t.key==="Escape"){t.stopPropagation()}};this.onCheckedValueChangedHandler=t=>{const e=t.currentTarget;this.callback.commitEditValueChange(+e.id,this.params.name,e.checked)};this.onCheckedClickedHandler=t=>{if(this.readonly){t.preventDefault()}};this.onInputBlurHandler=t=>{this.enableEditMode(t.currentTarget,false);this.undoEdit(t.currentTarget)};this.onInputChangedHandler=t=>{let e=t.currentTarget.value;switch(this.params.format){case"text":break;case"icon":break;default:e=h.convert(e,"string","number");if(isNaN(e)){return this.undoEdit(t.currentTarget)}}this.callback.commitEditValueChange(+t.currentTarget.id,this.params.name,e);this.undoEdit(t.currentTarget,true)};this.onCopyHandler=t=>{const e=t.target;if(e&&e.innerText){const t=e.innerText;navigator.clipboard.writeText(t)}};this.onKeyDownHandler=t=>{const e=t.target;if(e&&e.innerText){const i=e.innerText;switch(t.key){case"control":case"c":if(t.ctrlKey){navigator.clipboard.writeText(i)}break}}};this.onInputKeyHandler=t=>{switch(t.key){case"Escape":this.undoEdit(t.currentTarget);break;case"F2":{this.enableEditMode(t.currentTarget,!this.editMode);t.stopPropagation();break}case" ":t.stopPropagation();break;case"ArrowLeft":case"ArrowRight":case"Home":case"End":if(this.editMode){t.stopPropagation()}break}};this.onInputDoubleClickHandler=t=>{t.currentTarget.select();t.preventDefault()};this.onSelectChangedHandler=t=>{this.callback.commitEditValueChange(-1,this.params.name,t.detail.value)};this.setFocusOnSelect=t=>{const e=t.currentTarget;const i=e.firstElementChild;i?.setFocus?.()};this.onSelectTabIntoHandler=t=>{t.currentTarget.parentElement?.focus()};this.onInputClickHandler=t=>{const e=t.currentTarget;let i=""+e?.id;if(i===""&&e?.firstElementChild){i=""+e.firstElementChild?.id}this.params.rowClicked.emit({row:+i})};this.onIconClickedHandler=t=>{const e=t.currentTarget;const i="info";let s=""+e?.id;if(s===""&&e?.firstElementChild){s=""+e.firstElementChild?.id}const[o,r,n]=s.split("_");this.params.iconClicked.emit({row:+r,iconName:i,iconIndex:+n});this.params.rowClicked.emit({row:+r})};this.iconFolderPath=o("../assets/icons/")}getDisplayValue(t){let e;switch(this.params.format){case"text":e=t?.toString();break;case"icon":e=t?.toString();break;default:e=h.convert(t,typeof t,this.params.format,this.params.precision)||""}return e??""}undoEdit(t,e=false){const i=this.callback.getCommittedEditValue(+t.id,this.params.name);t.value=this.getDisplayValue(i);if(e){t.select()}else{t.setSelectionRange(t.value.length,t.value.length,"none")}}enableEditMode(t,e){if(this.editMode!==e){this.editMode=e;this.params.el.f2EditMode=e;this.params.editModeChanged.emit({value:e});if(this.editMode!==t.classList.contains(k)){if(this.editMode){t.classList.add(k)}else{t.classList.remove(k)}}}}get readonly(){return this.callback.readonly||this.params.readonly}renderCell(t,e,s,o,r){const n=this.params.name;const l=e.getValue(n);const a=this.getDisplayValue(l);const d=l===undefined||this.params.minimized||this.params.hidden;let f=e.getPartName(n);f=f?" "+f:"";const g=this.readonly;let u;if(this.params.format==="icon"){const e=[];let s=[];if(Array.isArray(l)){s=l}for(let o=0;o<s.length;o++){const{name:r,colorName:n,tooltip:h}=s[o];const c=h&&h.length>0;const l=r.split(":");let a=`${this.iconFolderPath}filled/navigation.svg#${r}`;if(l.length===3){a=`${this.iconFolderPath}${l[0]}/${l[1]}.svg#${l[2]}`}else if(l.length===2){a=`${this.iconFolderPath}filled/${l[0]}.svg#${l[1]}`}if(r.length>0){e.push(i("span",{onClick:this.onIconClickedHandler},i("svg",{role:"img",class:n?`icon ${n}-color`:"icon",id:`gridicon_${t}_${o}`,style:{margin:"1px"}},i("use",{xlinkHref:a})),c&&i("gc-widget-tooltip",{id:`gridtooltip_${t}`,text:`${h}`,"anchor-id":`gridicon_${t}_${o}`})))}}u=i("div",null,e)}else if(this.params.format==="boolean"){u=i("input",{type:"checkbox",id:`${t}`,checked:a||false,class:"small",hidden:d,onChange:this.onCheckedValueChangedHandler,onClick:this.onCheckedClickedHandler,tabIndex:r,onKeyDown:this.onCheckboxKeyHandler,part:`checkbox-editor${f}`})}else if(o&&!g&&!d&&this.params.options&&this.params.options.length>0){const t=c.parseArrayProperty(this.params.options)??[];const e=t?.map((t=>h.convert(t,typeof t,this.params.format,this.params.precision)));u=i("div",{tabIndex:-1,onFocus:this.setFocusOnSelect},i("gc-widget-select",{"selected-value":l,values:this.params.options,preventEditWhenClosed:true,labels:`${e.join("|")}|`,"onSelected-value-changed":this.onSelectChangedHandler,part:`select-editor${f}`,class:"hiddenWithoutFocus",style:{"--gc-text-align":`${this.params.align}`}}),i("span",{innerHTML:a,class:"hiddenWithFocus",tabIndex:r,onFocus:this.onSelectTabIntoHandler}))}else if(g||this.params.options&&this.params.options.length>0){u=i("span",{hidden:d,onKeyDown:this.onKeyDownHandler,onCopy:this.onCopyHandler,onClick:this.onInputClickHandler,id:`${t}`,innerHTML:a,tabIndex:r,part:f,class:`${o?"selected":""}`})}else{u=i("input",{type:"text",hidden:d,id:`${t}`,value:a,onDblClick:this.onInputDoubleClickHandler,onBlur:this.onInputBlurHandler,onChange:this.onInputChangedHandler,class:`${o?"selected":""}`,onKeyDown:this.onKeyDownHandler,onCopy:this.onCopyHandler,tabIndex:r,part:`input-editor${f}`,onClick:this.onInputClickHandler,readonly:e.isReadOnly(n),style:{margin:"0px","text-align":`${this.params.align}`}})}return{element:u,focusable:!d}}get align(){return this.params.align||"start"}saveEditorSelectionState(t){if(this.readonly){return}if(this.params.format==="boolean"){return}if(this.params.options&&this.params.options.length>0){return}const e=t;return{start:e.selectionStart??0,end:e.selectionEnd??0,direction:e.selectionDirection?e.selectionDirection:"none",editMode:this.editMode}}restoreEditorSelectionState(t,e){if(this.readonly){return}if(this.params.options&&this.params.options.length>0){if(e.hint==="click"||e.hint==="F2"){t.firstElementChild?.setState(true)}}else if(this.params.format!=="boolean"){const i=t;if(e.selectAll){i.select()}else if(e.selectionState){i.setSelectionRange?.(e.selectionState.start,e.selectionState.end,e.selectionState.direction)}this.enableEditMode(t,e.hint==="F2"||e.selectionState?.editMode||false)}}get hideFocusRectangle(){return!this.readonly&&this.params.format!=="boolean"}getSpan(t,e){return e.getSpan(this.params.name)}}let C=class{constructor(i){t(this,i);this.editModeChanged=e(this,"f2-edit-mode-changed",7);this.iconClicked=e(this,"icon-clicked",7);this.rowClicked=e(this,"row-clicked",7);this.minimizedChanged=e(this,"minimized-changed",7);this.cssPropertyChanged=e(this,"css-property-changed",7);this.align="start";this.base=new class extends l{get element(){return this.parent.el}}(this);this.onCssStyleChanged=async()=>{const t=await this.getCSSProperty("--gc-text-align")??"start";if(t!==this.align&&(t==="start"||t==="center"||t==="end")){this.align=t;this.base.parentGrid?.redraw()}};this.format="text";this.readonly=false;this.hideMinimizeAction=false;this.minimized=false;this._refresh=0;this.hidden=false}connectedCallback(){this.onCssStyleChanged();this.el.addEventListener("css-property-changed",this.onCssStyleChanged)}disconnectedCallback(){this.el.removeEventListener("css-property-changed",this.onCssStyleChanged)}async createCellRenderer(t){this.base.parentGrid=t;return new y(this,t)}onColumnPropertyChanged(){this.base.parentGrid?.redraw()}onMinimizedChanged(){this.minimizedChanged.emit({value:this.minimized})}componentDidLoad(){this.el.style.setProperty("display","block","important")}render(){return this.base.renderHeader()}async setCSSProperty(t,e){e=e.trim();if(await this.getCSSProperty(t)!==e){this.el.style.setProperty(t,e);this.cssPropertyChanged.emit({name:t,value:e})}}async getCSSProperty(t){return getComputedStyle(this.el).getPropertyValue(t).trim()}async refresh(){this._refresh++}get el(){return s(this)}static get watchers(){return{format:["onColumnPropertyChanged"],precision:["onColumnPropertyChanged"],options:["onColumnPropertyChanged"],readonly:["onColumnPropertyChanged"],hidden:["onColumnPropertyChanged"],hideMinimizeAction:["onColumnPropertyChanged"],minimized:["onColumnPropertyChanged","onMinimizedChanged"]}}};C.style=w;const z=":host{background-color:var(--gc-heading-color, var(--gc-border-color, var(--theme-border-color, #e5e5e5)));font-weight:var(--gc-font-weight, 500);font-size:var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px)));font-style:var(--gc-font-style, normal);white-space:nowrap;margin:0px;position:sticky;top:0%;text-align:var(--gc-heading-text-align, center);width:100%;align-self:stretch;box-sizing:border-box}:host(:focus),:host *:focus{outline:none}.header-container{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:center;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)))}.header-container>*:not(.stretch){flex-shrink:0}.stretch{flex:1}label,gc-widget-label{overflow:hidden;text-overflow:ellipsis;padding:5px 5px 5px 5px}slot::slotted(*:focus),.action:focus{outline:1px dotted var(--gc-focus-color, var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555))));outline-offset:1px}.action{--gc-color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));cursor:pointer}";class ${constructor(t,e){this.params=t;this.parentTree=e;this.iconFolderPath=o("../assets/icons/");this.onClickHandler=t=>{this.parentTree.toggleOpen(+t.currentTarget.id)};this.onInfoClickHandler=t=>{this.params.infoIconClicked.emit({row:+t.currentTarget.id})};this.onKeyHandler=t=>{if(t.key===" "||t.key==="Enter"){this.parentTree.toggleOpen(+t.currentTarget.id)}else if(t.key==="Escape"){t.stopPropagation()}else if(t.key==="F1"&&this.params.showInfoIcon){t.stopPropagation();this.onInfoClickHandler(t)}}}renderCell(t,e,s,o,r){const n=`tree${t}`;const h="chevron_right";const c=`${this.iconFolderPath}filled/navigation.svg#${h}`;let l;const a=e.rowIcon;if(a){const t=a.split(":");if(t.length===3){l=`${this.iconFolderPath}${t[0]}/${t[1]}.svg#${t[2]}`}else if(t.length===2){l=`${this.iconFolderPath}filled/${t[0]}.svg#${t[1]}`}}const d=this.params.minimized||this.params.hidden;let f;if(this.params.showInfoIcon){f=`${this.iconFolderPath}filled/action.svg#help_outline`}const g=i("span",{key:n,id:`${t}`,hidden:d,style:{padding:"0px 2px 0px 3px"},class:"flex-row",tabIndex:r,onKeyDown:this.onKeyHandler},i("span",{style:{width:this.getPadding(e),display:"inline-block"}}),i("svg",{role:"img",class:"icon",id:`${t}`,onClick:this.onClickHandler,style:{transform:this.getTranslation(e),visibility:e.isExpandable?"":"hidden"}},i("use",{xlinkHref:c})),e.isBusy?i("div",{class:"progress"}):null,i("label",{key:n+"label",id:`${t}`,class:"flex",part:this.getPart(e),onDblClick:this.onClickHandler},l?i("svg",{role:"img",class:"icon tree"},i("use",{xlinkHref:l})):null,e?.getValue(this.params.name||"name")||"",f?i("svg",{role:"img",id:`${t}`,class:"icon info",onClick:this.onInfoClickHandler,style:{display:e.isExpandable?"none":""}},i("use",{xlinkHref:f})):null));return{element:g,focusable:!d}}getPadding(t){return`${(t?.indent||0)*20}px`}getTranslation(t){return`${t?.isOpen?"rotate(90deg)":""}`}getPart(t){return`${t?.isOpen?"open branch":t?.isExpandable?"closed branch":"leaf"}`}getSpan(t,e){return e.getSpan?.(this.params.name)||1}}let S=class{constructor(i){t(this,i);this.infoIconClicked=e(this,"info-icon-clicked",7);this.minimizedChanged=e(this,"minimized-changed",7);this.cssPropertyChanged=e(this,"css-property-changed",7);this.base=new class extends l{get element(){return this.parent.el}}(this);this.showInfoIcon=false;this.hideMinimizeAction=false;this.minimized=false;this._refresh=0;this.hidden=false}async createCellRenderer(t){this.base.parentGrid=t;return new $(this,t)}onColumnPropertyChanged(){this.base.parentGrid?.redraw()}onMinimizedChanged(){this.minimizedChanged.emit({value:this.minimized})}componentDidLoad(){this.el.style.setProperty("display","block","important")}render(){return this.base.renderHeader()}async setCSSProperty(t,e){e=e.trim();if(await this.getCSSProperty(t)!==e){this.el.style.setProperty(t,e);this.cssPropertyChanged.emit({name:t,value:e})}}async getCSSProperty(t){return getComputedStyle(this.el).getPropertyValue(t).trim()}async refresh(){this._refresh++}get el(){return s(this)}static get watchers(){return{showInfoIcon:["onColumnPropertyChanged"],hidden:["onColumnPropertyChanged"],hideMinimizeAction:["onColumnPropertyChanged"],minimized:["onColumnPropertyChanged","onMinimizedChanged"]}}};S.style=z;export{x as gc_widget_grid,C as gc_widget_grid_data_column,S as gc_widget_grid_tree_column};
//# sourceMappingURL=p-ba70efef.entry.js.map
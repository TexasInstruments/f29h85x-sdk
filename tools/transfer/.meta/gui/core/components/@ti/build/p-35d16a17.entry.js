import{r as t,c as i,h as e,g as s,a as o}from"./p-5bb37414.js";import{nullDataProvider as r}from"../gc-widget-grid/lib/NullDataProvider";import{GcConsole as n}from"../gc-core-assets/lib/GcConsole";import{DataConverter as h}from"../gc-core-databind/lib/CoreDatabind";import{GcUtils as l}from"../gc-core-assets/lib/GcUtils";import{W as c}from"./p-81983aeb.js";import"./p-efd2e5c1.js";import"../gc-core-assets/lib/GcFiles";import"../gc-core-assets/lib/GcLocalStorage";import"../gc-widget-message-dialog/lib/GcMessageDialog";class a{constructor(){this.tos={};this._filterFn=v}push(t,i){this.tos={filteredRows:t,filterByText:i,next:this.tos}}pop(t,i,e=false){if(e||!i||t!==this.filterFn){this.tos={}}else{while(this.tos.next&&i.indexOf(this.tos.filterByText)<0){this.tos=this.tos.next}}this._filterFn=t;return this.tos.filteredRows}get filterByText(){return this.tos.filterByText}get filterFn(){return this._filterFn}}class d{constructor(t){this.dataProvider=t;this.isDisposed=false;this.selection=new Map;this.filterStack=new a;this.size=t.rowCount}get rowCount(){return this.filteredRows?this.filteredRows.length:this.size}getName(t){return""+(this.dataProvider.getValue(t,"name")||t)}dispose(){this.isDisposed=true}getRow(t,i){return new g(this,t,false,i)}getRelativePos(t){return t}parseRowFromPathSegment(t){var i;const e=t.charAt(0);let s=-1;if(e<"0"||e>"9"){if(this.dataProvider.lookupRowByName){s=(i=this.dataProvider.lookupRowByName(t))!==null&&i!==void 0?i:-1}}else{s=+t}return s}findRowByPath(t,i=0,e){if(i!==t.length-1){return undefined}const s=this.parseRowFromPathSegment(t[i]);if(s>=0&&s<this.size){return new g(this,+s,true,e)}}isOpen(t){return false}setSelected(t,i){if(!i){this.selection.delete(t)}else{this.selection.set(t,true)}}isSelected(t){var i;return(i=this.selection.get(t))!==null&&i!==void 0?i:false}sortAndFilter(t,i=false,e,s){if(!t){this.sortedRows=undefined}else{if(!this.sortedRows){this.sortedRows=new Array(this.size).fill(null).map(((t,i)=>i))}this.sortedRows=this.sortedRows.sort(((i,e)=>{if(this.dataProvider.isExpandable){const t=this.dataProvider.isExpandable(i)||false;const s=this.dataProvider.isExpandable(e)||false;if(t!==s){return t?-1:+1}}const s=this.dataProvider.getValue(i,t);const o=this.dataProvider.getValue(e,t);if(s>o){return+1}if(s<o){return-1}return i-e}));if(i){this.sortedRows=this.sortedRows.map(((t,i,e)=>e[e.length-1-i]))}}this.filter(e,s,true)}lookupVirtualRow(t){var i;return this.filteredRows?(i=this.filteredRows[t])!==null&&i!==void 0?i:-1:t}lookupFilteredRow(t){return this.filteredRows?this.filteredRows.indexOf(t):t}filter(t,i,e=false){this.filteredRows=this.filterStack.pop(t,i,e)||this.sortedRows;if(i&&this.filterStack.filterByText!==i){if(!this.filteredRows){this.filteredRows=new Array(this.size).fill(null).map(((t,i)=>i))}this.filteredRows=this.filteredRows.filter((e=>this.filterRow(e,t,i)));this.filterStack.push(this.filteredRows,i)}}filterRow(t,i,e){return i(t,this.dataProvider,e,false)}saveExpandedStates(){return new Map}async restoreExpandedStates(t,i){return}isBusy(t){return false}isReadOnly(t,i){var e,s;return((s=(e=this.dataProvider).isReadonly)===null||s===void 0?void 0:s.call(e,t,i))||false}hasChildren(t){return false}setVisibility(t,i){var e;if(this.dataProvider.setVisibility){if(!this.visible){this.visible=new Map}let s=(e=this.visible.get(t))!==null&&e!==void 0?e:0;s+=i?1:-1;if(s<=0){this.visible.delete(t)}else{this.visible.set(t,s)}if(i?s===1:s===0){this.dataProvider.setVisibility(t,i)}}}}class f extends d{constructor(t){super(t);this.dataProvider=t;this.sortDescending=false;this.children=new Array(this.size).fill(null).map(((t,i)=>({start:i,size:1,selected:false})));this.filteredChildren=this.children;this._rowCount=this.size}get rowCount(){return this._rowCount}collapse(t){const i=this.children[t];if(this.isDisposed||!i){return 0}if(i.expandingPromise){i.expandingCancelled=true}if(!i.node){return 0}i.expandedStates=i.node.saveExpandedStates();const e=i.node.rowCount;i.node.dispose();i.node=undefined;i.size=1;return-e}async expand(t,i,e,s){const o=this.children[t];if(this.isDisposed||o.node){return}if(o.expandingCancelled){o.expandingCancelled=false;if(o.expandingPromise){return o.expandingPromise}}const r=s||this.dataProvider.getChildDataProvider(t);if(r instanceof Promise){o.expandingPromise=r;i(0);s=await r;if(this.isDisposed){return}}else{s=r}let n=0;o.expandingPromise=undefined;if(o.expandingCancelled){o.expandingCancelled=false}else if(s){if(!s.isExpandable){o.node=new d(s)}else{o.node=new f(s)}o.node.sortAndFilter(this.sortByColumnName,this.sortDescending,this.filterStack.filterFn,this.filterStack.filterByText);n=o.node.rowCount}i(n);e=e||o.expandedStates;o.expandedStates=undefined;if(s&&e&&o.node instanceof f){await o.node.restoreExpandedStates((t=>{i(t)}),e)}}async expandAll(t,i=100){if(i>0){i=i-1;await Promise.all(this.filteredChildren.map((async(e,s)=>{if(this.isDisposed||e.node){return}const o=this.lookupVirtualRow(s);if(this.dataProvider.isExpandable(o)){e.expandedStates=undefined;const r=i=>{this.adjustSize(s,i);t(i)};await this.expand(o,r);if(e.node instanceof f){await e.node.expandAll(r,i)}}})))}}saveExpandedStates(){const t=super.saveExpandedStates();this.children.forEach(((i,e)=>{if(i.node){t.set(""+this.getName(e),i.node.saveExpandedStates())}}));return t}async restoreExpandedStates(t,i){if(i){await Promise.all(this.children.map((async(e,s)=>{if(this.isDisposed||e.node){return}const o=i.get(this.getName(s));if(o&&this.dataProvider.isExpandable(s)){await this.expand(s,(i=>{this.adjustSize(this.lookupFilteredRow(s),i);t(i)}),o)}})))}}isOpen(t){const i=this.children[t];return i.node!==undefined||i.expandingPromise!==undefined&&!i.expandingCancelled}dispose(){super.dispose();this.children.forEach((t=>{if(t.node){t.node.dispose()}}))}getChildIterator(t,i){const e=this.filteredChildren[t].node;if(e!==undefined&&e.rowCount>0){return new g(e,0,false,i)}return i.next(true)}adjustSize(t,i){var e,s;if(i===0||t<0){return}this._rowCount+=i;this.filteredChildren[t].size=((s=(e=this.filteredChildren[t].node)===null||e===void 0?void 0:e.rowCount)!==null&&s!==void 0?s:0)+1;for(let e=t+1;e<this.filteredChildren.length;e++){this.filteredChildren[e].start+=i}}findRowBinarySearch(t,i,e){const s=Math.round((t+i)/2);const o=this.filteredChildren[s];if(e<o.start){return this.findRowBinarySearch(t,s-1,e)}if(e>=o.start+o.size){return this.findRowBinarySearch(s+1,i,e)}return s}getRow(t,i){let e=0;let s=0;s=this.findRowBinarySearch(0,this.filteredChildren.length-1,t);const o=this.filteredChildren[s];e=o.start;const r=new g(this,s,false,i);return e===t?r:o.node.getRow(t-e-1,r)}getRelativePos(t){var i,e;let s=0;for(let o=0;o<t;o++){s+=((e=(i=this.filteredChildren[o].node)===null||i===void 0?void 0:i.rowCount)!==null&&e!==void 0?e:0)+1}return s}findRowByPath(t,i=0,e){if(i===t.length-1){return super.findRowByPath(t,i,e)}const s=this.parseRowFromPathSegment(t[i]);if(s>=0&&s<this.children.length&&this.children[s].node){return this.children[s].node.findRowByPath(t,i+1,new g(this,s,true,e))}}setSelected(t,i){const e=this.children[t];if(e){e.selected=i}}isSelected(t){const i=this.children[t];return i?i.selected:false}sortAndFilter(t,i=false,e,s){this.sortByColumnName=t;this.sortDescending=i;this.children.forEach((o=>{var r;return(r=o.node)===null||r===void 0?void 0:r.sortAndFilter(t,i,e,s)}));super.sortAndFilter(t,i,e,s);this.reindex()}reindex(){var t,i;this.filteredChildren=this.filteredRows?this.filteredRows.map(((t,i)=>this.children[this.lookupVirtualRow(i)])):this.children;let e=0;for(let s=0;s<this.filteredChildren.length;s++){const o=this.filteredChildren[s];o.start=e;o.size=((i=(t=o.node)===null||t===void 0?void 0:t.rowCount)!==null&&i!==void 0?i:0)+1;e+=o.size}this._rowCount=e}filter(t,i,e=false){this.children.forEach((e=>{var s;return(s=e.node)===null||s===void 0?void 0:s.filter(t,i)}));super.filter(t,i,e);this.reindex()}filterRow(t,i,e){var s,o;const r=this.children[t];const n=((o=(s=r.node)===null||s===void 0?void 0:s.rowCount)!==null&&o!==void 0?o:0)+1;return n>1||i(t,this.dataProvider,e,!!r.node)}isBusy(t){const i=this.children[t];return i.expandingPromise!==undefined&&!i.expandingCancelled}hasChildren(t){const i=this.children[t];return i.size>1}}class u{constructor(t,i){this.node=t;this.virtualRow=i;this.node.setVisibility(this.virtualRow,true)}clearVisibility(){this.node.setVisibility(this.virtualRow,false);return this}}class g{constructor(t,i=0,e=false,s){this.node=t;this.filteredRow=i;this.parent=s;this.dataProvider=t.dataProvider;this.indent=s?s.indent+1:0;if(e){this.virtualRow=i;this.filteredRow=this.node.lookupFilteredRow(i)}else{this.virtualRow=this.node.lookupVirtualRow(i)}}get hasChildren(){return this.node.hasChildren(this.virtualRow)}get path(){return(this.indent>0?`${this.parent.path}/`:"")+this.node.getName(this.virtualRow)}get pos(){const t=this.node.lookupFilteredRow(this.virtualRow);if(t<0){return t}return(this.indent>0?this.parent.pos+1:0)+this.node.getRelativePos(t)}next(t=false){var i;if(!t&&this.node.isOpen(this.virtualRow)){return this.node.getChildIterator(this.filteredRow,this)}this.filteredRow++;this.virtualRow=this.node.lookupVirtualRow(this.filteredRow);if(this.virtualRow<this.node.size&&this.virtualRow>=0){return this}return(i=this.parent)===null||i===void 0?void 0:i.next(true)}getValue(t){return this.dataProvider.getValue(this.virtualRow,t)}setValue(t,i){return this.dataProvider.setValue(this.virtualRow,t,i)}get isExpandable(){var t,i;return(i=(t=this.dataProvider).isExpandable)===null||i===void 0?void 0:i.call(t,this.virtualRow)}get rowIcon(){var t,i;return((i=(t=this.dataProvider).getIconName)===null||i===void 0?void 0:i.call(t,this.virtualRow,this.isOpen))||""}get isOpen(){return this.node.isOpen(this.virtualRow)}get isBusy(){return this.node.isBusy(this.virtualRow)}isReadOnly(t){return this.node.isReadOnly(this.virtualRow,t)}async open(t){if(this.isExpandable&&!this.isOpen){await this.node.expand(this.virtualRow,(i=>{this.adjustSize(i);t(i)}))}}close(){if(!this.isOpen){return 0}const t=this.node.collapse(this.virtualRow);this.adjustSize(t);return t}get selected(){return this.node.isSelected(this.virtualRow)}set selected(t){this.node.setSelected(this.virtualRow,t)}adjustSize(t){if(t===0){return}this.node.adjustSize(this.filteredRow,t);if(this.parent){this.parent.adjustSize(t)}}getPartName(t){var i,e,s;return(s=(e=(i=this.node.dataProvider).getPartName)===null||e===void 0?void 0:e.call(i,this.virtualRow,t,{selected:this.selected}))!==null&&s!==void 0?s:""}setVisibility(){if(this.node.dataProvider.setVisibility){return new u(this.node,this.virtualRow)}}getSpan(t){var i,e;return((e=(i=this.node.dataProvider).getSpan)===null||e===void 0?void 0:e.call(i,this.virtualRow,t))||1}}const v=(t,i,e)=>{var s;const o=""+i.getValue(t,"name");return(s=o===null||o===void 0?void 0:o.toLowerCase().includes(e.toLowerCase()))!==null&&s!==void 0?s:true};class p{constructor(t=r){this.root=new d(r);if(!t.isExpandable){this.root=new d(t)}else{this.root=new f(t)}}getRow(t){if(t>=0&&t<this.totalRowCount){return this.root.getRow(t)}}getRowByPath(t){return this.root.findRowByPath(t.split("/"))}setSelection(t){if(this.currentSelection){this.currentSelection.selected=false}this.currentSelection=t;if(this.currentSelection){this.currentSelection.selected=true}return this.currentSelection}get totalRowCount(){return this.root.rowCount}sortAndFilterBy(t,i=false,e=v,s){this.root.sortAndFilter(t,i,e,s)}filterBy(t=v,i){this.root.filter(t,i)}async expandAll(t,i=100){if(this.root instanceof f){await this.root.expandAll(t,i)}}saveExpandedStatesAndDispose(){const t=this.root.saveExpandedStates();this.root.dispose();return t}static create(t,i,e){const s=new p(i);s.root.restoreExpandedStates(t,e);return s}}const m=':host::-webkit-scrollbar,::-webkit-scrollbar{width:var(--gc-scrollbar-width, var(--theme-scrollbar-width, 8px));height:var(--gc-scrollbar-width, var(--theme-scrollbar-width, 8px))}:host::-webkit-scrollbar-track,::-webkit-scrollbar-track{background:var(--gc-scrollbar-track-background-color, var(--theme-scroll-track-color, rgba(35, 31, 32, 0.2)))}:host::-webkit-scrollbar-thumb,::-webkit-scrollbar-thumb{background:var(--gc-scrollbar-thumb-background-color, var(--theme-scroll-thumb-color, rgba(35, 31, 32, 0.65)))}:host::-webkit-scrollbar-thumb:hover,::-webkit-scrollbar-thumb:hover{background:var(--gc-scrollbar-thumb-background-color-hover, var(--theme-scroll-thumb-color-hover, rgba(35, 31, 32, 0.8)))}:host::-webkit-scrollbar-corner,::-webkit-scrollbar-corner{background:rgba(0, 0, 0, 0)}:host(:focus),:host *:focus{outline:none}:host{-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;font-family:var(--gc-font-family, var(--theme-font-family, "Roboto", "Open Sans", "Segoe UI", "Tahoma", "sans-serif"));font-size:var(--gc-font-size, var(--theme-font-size, 14px));font-weight:400;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));margin:var(--gc-margin, var(--theme-margin, 5px));display:inline-block;box-sizing:border-box}:host .user-select{-webkit-user-select:text;-khtml-user-select:text;-moz-user-select:text;-ms-user-select:text;-o-user-select:text;user-select:text}:host .text-link{color:var(--gc-link-color, var(--gc-link-color, var(--theme-link-color, #333333)));--gc-color:var(--gc-link-color, var(--gc-link-color, var(--theme-link-color, #333333)));--gc-text-decoration-hover:underline;--gc-cursor-hover:pointer}:host .text-link:not([disabled]):hover{text-decoration:underline;cursor:pointer}:host([hidden]){display:none !important}:host([readonly]) *{pointer-events:none}:host([disabled]) *{cursor:not-allowed}:host([caption]:not([caption=""])){margin-top:calc(var(--gc-margin, var(--theme-margin, 5px)) + var(--gc-caption-font-size, var(--theme-caption-font-size, 14px)) + 8px)}:host([caption]:not([caption=""])),:host([info-text]:not([info-text=""])){overflow:visible;position:relative}:host([caption=""][info-text]:not([info-text=""])),:host([info-text]:not([info-text=""]):not([caption])){margin-right:calc(var(--gc-margin, var(--theme-margin, 5px)) + 22px)}#elementWrapper{box-sizing:content-box;height:100%;width:100%;display:flex;align-items:center;min-height:inherit;max-height:inherit;min-width:inherit;max-width:inherit}.root-container{position:relative;display:flex;flex-direction:column;width:100%;height:100%;min-height:inherit;max-height:inherit;min-width:inherit;max-width:inherit}.root-container .header-container.top{top:var(--gc-header-container-top, calc(0px - 8px - var(--gc-caption-font-size, var(--theme-caption-font-size, 14px))));flex-direction:row}.root-container .header-container.side{right:-22px;flex-direction:column;height:inherit}.root-container .header-container{position:absolute;display:flex;align-items:center}.root-container .header-container .icon,.root-container .header-container gc-widget-icon{cursor:default;margin:auto;height:18px;width:18px;display:block;--gc-color:var(--gc-caption-info-color, var(--theme-caption-info-color, #98999b))}.root-container .header-container .caption{flex:1;cursor:default;white-space:nowrap;margin-right:2px;font-weight:var(--gc-caption-font-weight, var(--theme-caption-font-weight, 400));font-size:var(--gc-caption-font-size, var(--theme-caption-font-size, 14px));color:var(--gc-caption-font-color, var(--theme-caption-font-color, #999999))}.invisible{visibility:hidden}div.progress{border-color:var(--gc-progress-primary-color, var(--theme-secondary-color, #118899));border-bottom-color:var(--gc-progress-secondary-color, var(--gc-border-color, var(--theme-border-color, #e5e5e5)));border-style:solid;border-width:var(--gc-progress-thickness, 2px);border-radius:50%;width:var(--gc-progress-size, 14px);height:var(--gc-progress-size, 14px);animation:spin 0.8s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}:host{font-family:var(--gc-font-family, var(--theme-font-family, "Roboto", "Open Sans", "Segoe UI", "Tahoma", "sans-serif"));font-size:var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px)));font-weight:400;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));white-space:nowrap;border:2px solid var(--gc-border-color, var(--gc-border-color, var(--theme-border-color, #e5e5e5)));position:relative;line-height:var(--gc-row-height, calc(var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px))) + 10px))}:host([readonly]) *{pointer-events:auto !important}.grid{display:grid;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));background-color:var(--gc-background-color, var(--gc-background-color, var(--theme-background-color, #ffffff)));row-gap:0;column-gap:0;flex:1;overflow-x:auto;overflow-y:auto}.grid:not(.selectionDisabled) .grid-column:focus-within input[type=text][readonly],.grid:not(.selectionDisabled) .grid-column:focus-within .focused,.grid:not(.selectionDisabled) .grid-column:focus-within:not(.noOutline){outline:1px dotted var(--gc-outline-color-focus, var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555))));outline-offset:-3px}.grid.selectionDisabled .grid-row.selected input[type=text]:focus{border-color:transparent;background-color:transparent}.grid-row,.grid-content,.grid-header{display:contents}.grid-row[hidden],.grid-content[hidden],.grid-header[hidden]{display:none}.grid:not(.selectionDisabled) .grid-row:hover:not(.selected)>.grid-column{background-color:var(--gc-background-color-highlighted, var(--gc-background-color-highlighted, var(--theme-background-color-highlighted, #eeeeee)));color:var(--gc-font-color-highlighted, var(--gc-font-color-highlighted, var(--theme-font-color-highlighted, #555555)))}.grid-row.selected>.grid-column{background-color:var(--gc-background-color-selected-inactive, var(--gc-background-color-selected-inactive, var(--theme-background-color-selected-inactive, #e5e5e5)));color:var(--gc-font-color-selected-inactive, var(--gc-font-color-selected, var(--gc-font-color-selected, var(--theme-font-color-selected, #555555))))}.grid:focus-within .grid-row.selected>.grid-column{background-color:var(--gc-background-color-selected, var(--gc-background-color-selected, var(--theme-background-color-selected, #d9f1f4)));color:var(--gc-font-color-selected, var(--gc-font-color-selected, var(--theme-font-color-selected, #555555)))}.grid-column{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.grid-column.center{justify-content:center}.grid-column.end{justify-content:flex-end}.grid-column>*{padding:0px 5px 0px 5px}.container{display:flex;flex-direction:row;overflow:hidden;line-height:normal;position:relative;width:100%;height:100%}.grid-scrollbar{position:absolute;right:0px;top:0px;bottom:0px;outline:none;background-color:var(--gc-background-color, var(--gc-background-color, var(--theme-background-color, #ffffff)));overflow-y:scroll;overflow-x:hidden}.grid-scrollbar-content{width:1px}slot[name=columns]::slotted(*){--gc-color:var(--gc-heading-font-color, var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555))));border-color:var(--gc-background-color, var(--gc-background-color, var(--theme-background-color, #ffffff)));border-style:solid;border-width:1px 1px 0px 1px;--gc-font-color:var(--gc-heading-font-color);--gc-font-size:var(--gc-heading-font-size);--gc-font-weight:500;--gc-font-style:normal;z-index:1;}slot[name=columns]::slotted(*:first-child){border-width:1px 1px 0px 1px}input{font-family:var(--gc-font-family, var(--gc-font-family, var(--theme-font-family, "Roboto", "Open Sans", "Segoe UI", "Tahoma", "sans-serif")));font-size:var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px)));font-weight:400;margin:0px;width:100%;color:inherit;background-color:transparent;appearance:none;outline:none;border:2px solid transparent;box-sizing:border-box;vertical-align:middle}.grid-row.selected input[type=text]:focus{border:2px solid var(--gc-outline-color-focus, var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555))));background-color:var(--gc-background-color-input-focus, inherit);height:var(--gc-row-height, calc(var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px))) + 10px))}.grid-row.selected input[type=text]:focus.edit-mode{border-style:dashed}.grid-row.selected input[type=text]:focus[readonly]{border:2px solid transparent}.grid-row gc-widget-select{width:100%;height:var(--gc-row-height, calc(var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px))) + 10px));margin:0px;--gc-menuitem-background-color-selected:var(--gc-background-color-selected-inactive, var(--gc-background-color-selected-inactive, var(--theme-background-color-selected-inactive, #e5e5e5)));--gc-menuitem-color-selected:var(--gc-font-color-selected, var(--theme-font-color-selected, #555555))}.grid:focus-within .grid-row gc-widget-select{--gc-menuitem-background-color-selected:var(--gc-background-color-selected, var(--gc-background-color-selected, var(--theme-background-color-selected, #d9f1f4)))}input[type=checkbox]{height:18px;width:18px;appearance:none;border:2px solid var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));border-radius:4px;cursor:pointer;outline:none;transition:all 100ms cubic-blzier(0.4, 0, 0.2, 1);position:relative;margin:0px}input[type=checkbox].small{height:15px;width:15px;border-radius:3px}input[type=checkbox]:checked{box-sizing:border-box;background-color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)))}input[type=checkbox]:checked::after{box-sizing:border-box;position:absolute;display:block;top:1px;left:1px;width:12px;height:8px;content:" ";transform:rotate(-45deg);border-bottom:2px solid var(--gc-background-color, var(--gc-background-color, var(--theme-background-color, #ffffff)));border-left:2px solid var(--gc-background-color, var(--gc-background-color, var(--theme-background-color, #ffffff)))}input[type=checkbox]:checked.small::after{left:0px;width:10px;height:6px}@keyframes ckeckbox-focus-shadow{from{box-shadow:0 0 0 2px var(--gc-focus-color-highlight, var(--theme-focus-color-highlight, #9ed6df))}to{box-shadow:0 0 0 2px var(--gc-focus-color-highlight-25pct, var(--theme-focus-color-highlight-25pct, rgba(158, 214, 223, 0.25)))}}input[type=checkbox]:focus{animation:ckeckbox-focus-shadow linear 1s infinite alternate}.grid-row:hover input[type=checkbox]{border-color:var(--gc-font-color-highlighted, var(--gc-font-color-highlighted, var(--theme-font-color-highlighted, #555555)))}.grid-row:hover input[type=checkbox]:checked{background-color:var(--gc-font-color-highlighted, var(--gc-font-color-highlighted, var(--theme-font-color-highlighted, #555555)))}.grid-row:hover input[type=checkbox]:checked::after{border-bottom:2px solid var(--gc-background-color-highlighted, var(--gc-background-color-highlighted, var(--theme-background-color-highlighted, #eeeeee)));border-left:2px solid var(--gc-background-color-highlighted, var(--gc-background-color-highlighted, var(--theme-background-color-highlighted, #eeeeee)))}.grid-row.selected input[type=checkbox]{border-color:var(--gc-font-color-selected, var(--gc-font-color-selected, var(--theme-font-color-selected, #555555)))}.grid-row.selected input[type=checkbox]:checked{background-color:var(--gc-font-color-selected, var(--gc-font-color-selected, var(--theme-font-color-selected, #555555)))}.grid-row.selected input[type=checkbox]:checked::after{border-bottom:2px solid var(--gc-background-color-selected-inactive, var(--gc-background-color-selected-inactive, var(--theme-background-color-selected-inactive, #e5e5e5)));border-left:2px solid var(--gc-background-color-selected-inactive, var(--gc-background-color-selected-inactive, var(--theme-background-color-selected-inactive, #e5e5e5)))}.grid:focus-within .grid-row.selected input[type=checkbox]:checked::after{border-bottom:2px solid var(--gc-background-color-selected, var(--gc-background-color-selected, var(--theme-background-color-selected, #d9f1f4)));border-left:2px solid var(--gc-background-color-selected, var(--gc-background-color-selected, var(--theme-background-color-selected, #d9f1f4)))}.grid-row.selected:hover .icon.info,.grid-row.selected .icon:not(.tree):not(.info){fill:var(--gc-font-color-selected, var(--gc-font-color-selected, var(--theme-font-color-selected, #555555)))}.grid-row:hover .icon.info{fill:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)))}.grid-column:not(:focus-within) .hiddenWithoutFocus{display:none !important}.grid-column:focus-within .hiddenWithFocus{display:none !important}.icon{width:18px;height:18px;stroke-width:0;vertical-align:middle;fill:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));cursor:pointer}.icon.tree{fill:var(--gc-icon-color, var(--theme-secondary-color, #118899));margin-right:3px}.icon.info{fill:transparent;width:14px;height:14px;margin-left:5px}[readonly]{pointer-events:none}div.progress{margin-right:5px}.flex-row:not([hidden]){display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;width:100%;box-sizing:border-box}.flex-row:not([hidden])>*{flex-shrink:0;box-sizing:border-box}.flex-row:not([hidden])>*.flex{flex:1 1 3em}.flex-row:not([hidden])>label{overflow:hidden;text-overflow:ellipsis;line-height:100%;vertical-align:middle}';const b=["one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve"].reduce(((t,i,e)=>{t.set(i,e);return t}),new Map);let x=class{constructor(e){t(this,e);this.viewportChanged=i(this,"viewport-changed",7);this.selectedRowChanged=i(this,"selected-row-changed",7);this.selectedPathChanged=i(this,"selected-path-changed",7);this.cssPropertyChanged=i(this,"css-property-changed",7);this.treeStates=new p;this.startRow=0;this.nVisibleRows=0;this.pageSize=1;this.pageHeight=1;this.activeSelectedRow=-1;this.activeSelectedColumn=-1;this.rowHeight=24;this.columnHeadings=[];this.savedExpandedStatesMap=new Map;this.activeDataProviderId="";this.currentVisibleRows=[];this.viewportInfo={startRow:0,visibleRows:0};this.isScrolling=false;this.whenScrollingStartRowOffset=0;this.headerHeight=0;this.keepSelectedRowVisible=true;this.isScrollBarShowing=false;this.cellEditorEnabled=false;this.lastScrollTop=0;this.totalRows=0;this.columns=[];this.updateTotalRowCount=t=>{const i=this.treeStates.totalRowCount;if(this.totalRows!==i){this.totalRows=i;if(this.activeSelection){this.selectedRow=this.activeSelection.pos}this.logger.debug((()=>`Total number of rows changed to ${i}`))}else if(t===0){this.refresh()}};this.virtual=false;this.smoothScrolling=false;this.sortDescending=false;this.selectedRow=-1;this.selectedPath="";this.hideHeading=false;this.disableSelection=false;this.preventScroll=t=>{t.preventDefault();t.stopPropagation();this.scrollViewport(this.scrollTop)};this.doRepositionScrollThumb=()=>{this.repositionScrollThumbTimer=undefined;if(this.isScrolling||this.whenScrollingStartRowOffset===0){return}const t=this.whenScrollingStartRowOffset;this.whenScrollingStartRowOffset=0;this.logger.debug((()=>`Repositioning scroll thumb by ${t} rows`));this.scrollTop+=t*this.rowHeight};this.onScroll=()=>{const t=this.scrollTop;if(this.virtual){if(this.lastScrollTop!==t){if(this.el.shadowRoot.querySelector(".grid-focusable:focus-within")){this.saveActiveEditorSelectionState()}this.lastScrollTop=t}}else{this.scrollViewport(t)}if(this.repositionScrollThumbTimer!==undefined){this.stopRepositionScrollThumbTimer();this.startRepositionScrollThumbTimer()}this.updateViewportInfo("onScroll")};this.onSelectHandler=t=>{var i,e,s,o;const r=t.currentTarget;const n=r.id;const h=n.split(",");if(h.length===2){const t=+h[0];const n=+h[1];const l=n+this.getColumnSpan(r);this.logger.debug((()=>`onSelectHandler: click on cell x=${n} y=${t}`));if(t!==this.activeSelectedRow||this.activeSelectedColumn<n||this.activeSelectedColumn>=l){this.activeSelection=this.treeStates.setSelection(this.treeStates.getRow(t+this.startRow));this.activeSelectedColumn=n;this.selectedRow=(e=(i=this.activeSelection)===null||i===void 0?void 0:i.pos)!==null&&e!==void 0?e:-1;this.selectedPath=(o=(s=this.activeSelection)===null||s===void 0?void 0:s.path)!==null&&o!==void 0?o:"";this.setFocusAfterRender={selectAll:false,hint:"click"};this.cellEditorEnabled=true}else if(!this.cellEditorEnabled){this.setFocusAfterRender={selectAll:false,hint:"click"};this.cellEditorEnabled=true}}};this.setFocusOnActiveEditor=()=>{var t,i;if(this.cellEditorEnabled&&this.hasSelection){const e=this.gridContent.children[this.activeSelectedRow];const s=this.getIndexOfActiveColumn(e===null||e===void 0?void 0:e.children,this.activeSelectedColumn);const o=e===null||e===void 0?void 0:e.children[s];const r=o.querySelector("*:focus-within");const n=o===null||o===void 0?void 0:o.firstElementChild;if(n&&!o.classList.contains("noFocus")&&!r){const e=this.columns[s];this.logger.debug((()=>`setFocusOnActiveEditor: focus redirected to editor x=${s} y=${this.activeSelectedRow}`));n.focus({preventScroll:true});let o={selectAll:false,hint:""};if(((t=this.editorSelectionState)===null||t===void 0?void 0:t.path)===this.selectedPath&&this.editorSelectionState.column===s){o={selectAll:false,selectionState:this.editorSelectionState.selectionState,hint:""};this.editorSelectionState=undefined}(i=e.restoreEditorSelectionState)===null||i===void 0?void 0:i.call(e,n,this.setFocusAfterRender||o)}}};this.setFocusOnCell=()=>{if(this.hasSelection){const t=this.gridContent.children[this.activeSelectedRow];const i=this.getIndexOfActiveColumn(t===null||t===void 0?void 0:t.children,this.activeSelectedColumn);const e=t===null||t===void 0?void 0:t.children[i];if(e){this.logger.debug((()=>`setFocusOnCell: focus redirected to cell x=${i} y=${this.activeSelectedRow}`));e.focus({preventScroll:true})}}};this.setFocusOnGrid=()=>{var t;if(this.hasSelection){const t=this.gridContent.children[this.activeSelectedRow];const i=this.getIndexOfActiveColumn(t===null||t===void 0?void 0:t.children,this.activeSelectedColumn);const e=t===null||t===void 0?void 0:t.children[i];const s=e===null||e===void 0?void 0:e.firstElementChild;if(this.cellEditorEnabled&&s&&!e.classList.contains("noFocus")){this.setFocusOnActiveEditor()}else{this.setFocusOnCell()}}else{this.logger.debug((()=>"setFocusOnGrid: focus set on grid"));(t=this.scrollContainer)===null||t===void 0?void 0:t.focus({preventScroll:true})}};this.onMousewheelHandler=t=>{if(this.isScrollBarShowing&&t.deltaY){t.preventDefault();this.scrollContainer.scrollBy(0,t.deltaY)}};this.onKeyHandler=t=>{switch(t.key){case"End":if(t.ctrlKey){this.moveToCell(t,this.totalRows)}else if(this.isScrollLock(t)){this.scrollToColumn(t,1,true)}else{this.moveToCell(t,0,this.gotoNextVisibleColumn(this.columns.length,-1))}break;case"Home":if(t.ctrlKey){this.moveToCell(t,-this.totalRows)}else if(this.isScrollLock(t)){this.scrollToColumn(t,-1,true)}else{this.moveToCell(t,0,this.gotoNextVisibleColumn(-1,+1))}break;case"PageUp":this.moveToCell(t,-this.pageSize);break;case"PageDown":this.moveToCell(t,+this.pageSize);break;case"ArrowUp":this.moveToCell(t,-1);break;case"ArrowDown":this.moveToCell(t,+1);break;case"ArrowLeft":if(this.isScrollLock(t)){this.scrollToColumn(t,-1)}else{this.moveToCell(t,0,this.gotoNextVisibleColumn(this.activeSelectedColumn,-1))}break;case"ArrowRight":if(this.isScrollLock(t)){this.scrollToColumn(t,1)}else{this.moveToCell(t,0,this.gotoNextVisibleColumn(this.activeSelectedColumn,+1))}break;case" ":t.preventDefault();break;case"Escape":if(this.cellEditorEnabled){this.cellEditorEnabled=false;this.setFocusAfterRender={selectAll:false,hint:t.key}}t.preventDefault();break;case"F2":if(!this.cellEditorEnabled){this.setFocusAfterRender={selectAll:true,hint:t.key};this.cellEditorEnabled=true}break}};this.onScrollingStarted=()=>{this.isScrolling=true};this.onScrollingFinished=()=>{this.isScrolling=false;this.startRepositionScrollThumbTimer()};this.onCSSPropertyChanged=()=>{const t=this.rowHeight;const i=this.scrollTop;this.updateRowHeight();let e=Math.round(i*(this.rowHeight/t-1));if(e!==0){if(e>0){const t=Math.ceil(e/this.rowHeight);e-=t*this.rowHeight;this.scrollTop=i+e;this.scrollRowsBy(t,false)}else{this.scrollTop=i+e}}this.refresh()};this._refresh=0;this.hidden=false;this.readonly=false}updateRowHeight(){const t=parseInt(getComputedStyle(this.el).getPropertyValue("line-height").trim());if(!isNaN(t)){this.rowHeight=t||1}}updateViewportInfo(t){var i;const e=((i=this.grid||this.el)===null||i===void 0?void 0:i.clientHeight)||0;const s=Math.floor((e-this.headerHeight)/this.rowHeight);const o=this.scrollTop;const r=Math.floor(o/this.rowHeight)+this.whenScrollingStartRowOffset;if(r!==this.viewportInfo.startRow||s!==this.viewportInfo.visibleRows){this.viewportInfo.startRow=r;this.viewportInfo.visibleRows=s;this.viewportChanged.emit({...this.viewportInfo,reason:t})}}get scrollTop(){var t,i;return Math.round((i=(t=this.scrollContainer)===null||t===void 0?void 0:t.scrollTop)!==null&&i!==void 0?i:0)}set scrollTop(t){if(!this.scrollContainer){return}t=Math.max(t,0);t=Math.min(t,this.scrollContainer.scrollHeight-this.scrollContainer.clientHeight);this.scrollContainer.scrollTo(0,t);const i=Math.round(t-this.scrollContainer.scrollTop);if(i!==0){this.scrollContainer.scrollBy(0,i);if(this.scrollTop===t){this.logger.warning((()=>`scrollTop has fractional error due to Chrome bug.  Added ${i} to scrollTop to compensate.`))}else{this.logger.error((()=>`scrollTop has fractional error due to Chrome bug, Adding ${i} to scrollTop did not work.`))}}}onSortByColumnChanged(){this.treeStates.sortAndFilterBy(this.sortByColumn,this.sortDescending,this.filterFn,this.filterText);this.updateTotalRowCount()}onFilterTextChanged(){this.treeStates.filterBy(this.filterFn,this.filterText);this.updateTotalRowCount()}onSelectedRowChanged(){var t,i,e,s;const o=(i=(t=this.activeSelection)===null||t===void 0?void 0:t.pos)!==null&&i!==void 0?i:-1;if(o!==this.selectedRow){this.activeSelection=this.treeStates.setSelection(this.treeStates.getRow(this.selectedRow));this.selectedPath=(s=(e=this.activeSelection)===null||e===void 0?void 0:e.path)!==null&&s!==void 0?s:""}if(this.selectedRow>=0&&this.keepSelectedRowVisible){let t;let i;const e=this.scrollTop+this.whenScrollingStartRowOffset*this.rowHeight;if(this.smoothScrolling){i=this.selectedRow*this.rowHeight-e;t=this.pageHeight-this.rowHeight}else{i=(this.selectedRow-Math.max(0,Math.floor(e/this.rowHeight)))*this.rowHeight;t=this.pageSize*this.rowHeight}if(i<0){this.scrollTop+=i-(this.smoothScrolling?0:e%this.rowHeight)}else if(i>t){this.scrollTop+=i-t-(this.smoothScrolling?0:e%this.rowHeight)}}this.selectedRowChanged.emit({value:this.selectedRow})}onSelectedPathChanged(){var t,i,e,s,o;const r=(i=(t=this.activeSelection)===null||t===void 0?void 0:t.path)!==null&&i!==void 0?i:"";const n=(e=this.selectedPath)!==null&&e!==void 0?e:"";if(r!==n){this.activeSelection=this.treeStates.setSelection(this.treeStates.getRowByPath(n));this.selectedRow=(o=(s=this.activeSelection)===null||s===void 0?void 0:s.pos)!==null&&o!==void 0?o:-1}this.selectedPathChanged.emit({value:this.selectedPath})}onVirtualChanged(){if(this.virtual){this.lastScrollTop=this.scrollTop}}async setDataProvider(t,i=0,e=""){var s;const o=this.selectedPath;if((s=this.scrollContainer)===null||s===void 0?void 0:s.firstElementChild){this.scrollContainer.firstElementChild.style.height="0px"}this.savedExpandedStatesMap.set(this.activeDataProviderId,this.treeStates.saveExpandedStatesAndDispose());this.activeDataProviderId=e;this.treeStates=p.create(this.updateTotalRowCount,t,this.savedExpandedStatesMap.get(this.activeDataProviderId));if(this.sortByColumn){this.treeStates.sortAndFilterBy(this.sortByColumn,this.sortDescending,this.filterFn,this.filterText)}else if(this.filterText){this.treeStates.filterBy(this.filterFn,this.filterText)}this.updateTotalRowCount();await this.expandToLevel(i);this.selectedPath=o;this.updateRowHeight();this.updateViewportInfo("setDataProvider");this.refresh()}async scrollRowsBy(t,i=true){if(t===0){return}this.logger.debug((()=>`scrollRowsBy = ${t}, selectedRow = ${this.selectedRow}, this.whenScrollingStartRowOffset = ${this.whenScrollingStartRowOffset}`));this.whenScrollingStartRowOffset+=t;this.startRepositionScrollThumbTimer();if(this.selectedRow>=0&&i){this.keepSelectedRowVisible=false;try{let i=this.selectedRow+t;if(i<0||i>this.totalRows){i=-1}this.selectedRow=i}finally{this.keepSelectedRowVisible=true}}this.updateViewportInfo("scrollRowsBy");this.refresh()}expandToLevel(t){return this.treeStates.expandAll(this.updateTotalRowCount,t)}async setFilterMethod(t){this.filterFn=t;if(this.filterText){this.treeStates.filterBy(this.filterFn,this.filterText);this.updateTotalRowCount()}}startRepositionScrollThumbTimer(){if(this.isScrolling||this.repositionScrollThumbTimer){return}this.repositionScrollThumbTimer=setTimeout(this.doRepositionScrollThumb,100)}stopRepositionScrollThumbTimer(){if(this.repositionScrollThumbTimer!==undefined){clearTimeout(this.repositionScrollThumbTimer)}this.repositionScrollThumbTimer=undefined}get hasSelection(){return this.activeSelectedRow>=0&&this.activeSelectedColumn>=0&&!this.disableSelection}getColumnSpan(t){const i=t.style["grid-column-end"];if(i===null||i===void 0?void 0:i.startsWith("span ")){return Number(i.substring("span ".length))}return 1}getIndexOfActiveColumn(t,i){if(!t||i<0){return i}let e=0;let s=0;for(;s<t.length;s++){const o=e;e=o+this.getColumnSpan(t[s]);if(i>=o&&i<e){break}}return s}forceActiveEditorToCommitChanges(){if(this.cellEditorEnabled){this.cellEditorEnabled=false;this.setFocusOnCell();this.cellEditorEnabled=true}}saveActiveEditorSelectionState(){var t,i;if(this.disableSelection){this.setFocus()}else if(this.cellEditorEnabled){const e=this.gridContent.children[this.activeSelectedRow];const s=this.getIndexOfActiveColumn(e===null||e===void 0?void 0:e.children,this.activeSelectedColumn);const o=this.columns[s];if(o===null||o===void 0?void 0:o.saveEditorSelectionState){const o=e===null||e===void 0?void 0:e.children[s].firstElementChild;if(o){this.editorSelectionState={path:this.selectedPath,column:s,selectionState:(i=(t=this.columns[s]).saveEditorSelectionState)===null||i===void 0?void 0:i.call(t,o)}}}this.forceActiveEditorToCommitChanges()}}isColumnVisible(t){const i=this.columnHeadings[t];return i&&!(i.hidden||i.minimized)}gotoNextVisibleColumn(t,i){do{t=t+i;if(t<0||t>=this.columns.length||isNaN(t)){return this.activeSelectedColumn}}while(!this.isColumnVisible(t));return t}isScrollLock(t){return this.selectedRow<0||this.disableSelection||t.getModifierState("ScrollLock")}moveToCell(t,i=0,e){var s,o,r,n;if(this.isScrollLock(t)&&i!==0){this.scrollTop+=i*this.rowHeight-(this.smoothScrolling?0:this.scrollTop%this.rowHeight);if(this.disableSelection){this.setFocusAfterRender={selectAll:false,hint:t.key}}}else if(this.selectedRow>=0){let h=i+this.selectedRow;const l=Math.abs(this.whenScrollingStartRowOffset);h=Math.max(h,l);h=Math.min(h,(this.totalRows||0)-1-l);if(h!==this.selectedRow||e!==this.activeSelectedColumn&&e!==undefined){this.logger.debug((()=>`moveToCell after key ${t.key} pressed.  Removing focus on active editor at x=${this.activeSelectedColumn} y=${this.activeSelectedRow}`));this.forceActiveEditorToCommitChanges();if(e!==undefined){this.activeSelectedColumn=e}this.cellEditorEnabled=true;this.setFocusAfterRender={selectAll:true,hint:t.key};this.activeSelection=this.treeStates.setSelection(this.treeStates.getRow(h));this.selectedRow=(o=(s=this.activeSelection)===null||s===void 0?void 0:s.pos)!==null&&o!==void 0?o:-1;this.selectedPath=(n=(r=this.activeSelection)===null||r===void 0?void 0:r.path)!==null&&n!==void 0?n:""}if(e!==undefined){const t=this.gridContent.children[h-this.startRow];const i=this.getIndexOfActiveColumn(t===null||t===void 0?void 0:t.children,e);const s=t===null||t===void 0?void 0:t.children[i];if(s){this.scrollIntoViewHorizontally(s)}}}t.preventDefault();t.stopPropagation()}scrollToColumn(t,i,e=false){let s;const o=this.grid.scrollLeft;const r=this.grid.clientWidth;const n=Math.min(15,r/4);if(!e){let t;s=this.gridContent.firstElementChild.firstElementChild;while(s&&(i<0?s.offsetLeft<o-n:s.offsetLeft<o+n)){t=s;s=s.nextElementSibling}if(i<0){s=t}}if(s){const t=s.offsetLeft-o;this.grid.scrollBy(i<0?Math.max(-r,t):Math.min(r,t),0)}else{this.grid.scrollBy(i<0?-this.grid.scrollWidth:this.grid.scrollWidth,0)}t.preventDefault();t.stopPropagation()}calculateVisibleRowCount(t){const i=Math.ceil(t/this.rowHeight);return Math.min(this.totalRows,i)}calculateStartRowAndScrollTop(t,i=0){let e=Math.max(0,Math.floor(i/this.rowHeight)+this.whenScrollingStartRowOffset);let s=this.smoothScrolling?i%this.rowHeight:0;const o=e+t-this.totalRows;if(o>0){s+=o*this.rowHeight;e-=o}return[e,s]}getGridColumnWidths(){const t=this.columnHeadings.map(((t,i)=>{if(t.hidden===true){return"0px"}if(t.minimized===true){return"min-content"}const e=getComputedStyle(t).getPropertyValue("--gc-column-width");if(e){return e}if(t.hasAttribute("flex")){return(getComputedStyle(t).getPropertyValue("flex-grow")||"1")+"fr"}if(t.style.width){return t.style.width}return"min-content"}));return t.join(" ")}renderRows(t,i){this.activeSelectedRow=-1;const s=this.currentVisibleRows;this.currentVisibleRows=[];let o=this.treeStates.getRow(t);const r=new Array(i).fill(null).map(((t,i)=>{try{const t=o.setVisibility();if(t){this.currentVisibleRows.push(t)}const s=o.selected;const r=s?!this.disableSelection&&this.activeSelectedColumn:-1;const n=this.cellEditorEnabled?r:-1;if(s){this.activeSelectedRow=i}let h=1;const l=this.columns.map(((t,l)=>{var c,a;if(h>1){h--;return null}h=(a=(c=t.getSpan)===null||c===void 0?void 0:c.call(t,i,o))!==null&&a!==void 0?a:1;if(h<0){h=this.columns.length-l}const d=n>=l&&n<l+h;const{element:f,focusable:u}=t.renderCell(i,o,s,d,d?0:-1);const g=`grid-column ${t.align||"start"}${this.cellEditorEnabled&&u?t.hideFocusRectangle?" noOutline":"":" noFocus"}`;return e("div",{class:g,key:`${l}`,id:`${i},${l}`,tabIndex:(!this.cellEditorEnabled||!u)&&r===l?0:-1,onFocus:this.disableSelection?this.setFocus:this.setFocusOnActiveEditor,onMouseDown:this.disableSelection?null:this.onSelectHandler,style:h>1?{"grid-column-end":`span ${h}`}:{}},f)}));return e("div",{class:`grid-row${s?" selected":""}`,key:i,id:`${i}`},l)}catch(t){return e("div",null,t.message||t.toString())}finally{o=o.next()}}));s.forEach((t=>t.clearVisibility()));return r}render(){this.updateRowHeight();const t=(this.grid||this.el).clientHeight;this.nVisibleRows=this.virtual?this.calculateVisibleRowCount(t):this.totalRows;this.startRow=this.calculateStartRowAndScrollTop(this.nVisibleRows,this.scrollTop)[0];const i=this.getGridColumnWidths();return e("div",{key:"container",class:"container"},e("template",null,e("slot",null)),e("div",{key:"grid",class:`grid${this.disableSelection?" selectionDisabled":""}`,ref:t=>this.grid=t,onKeyDown:this.onKeyHandler,onWheel:this.onMousewheelHandler,onScroll:this.preventScroll,style:{"grid-template-rows":`${this.hideHeading?"":"min-content "}repeat(${this.nVisibleRows||1}, ${this.rowHeight}px)`,"grid-template-columns":`${i}`}},e("div",{key:"grid-header",class:"grid-header",hidden:this.hideHeading},e("slot",{name:"columns"})),e("div",{key:"grid-content",class:"grid-content grid-focusable",ref:t=>this.gridContent=t,tabIndex:-1},this.renderRows(this.startRow,this.nVisibleRows)),e("div",{key:"grid-padding",class:"grid-padding",style:{height:`${this.smoothScrolling?0:this.rowHeight}px`}})),e("div",{key:"grid-scrollbar",tabIndex:this.hasSelection?-1:0,class:"grid-scrollbar grid-focusable",onMouseDown:this.onScrollingStarted,onMouseUp:this.onScrollingFinished,onKeyDown:this.onKeyHandler,onFocus:this.disableSelection?null:this.setFocusOnCell,ref:t=>this.scrollContainer=t,onScroll:this.onScroll},e("div",{key:"grid-scrollbar-content",class:"grid-scrollbar-content"})))}setupScrollbar(){const t=this.el.children;this.headerHeight=0;if(!this.hideHeading){this.headerHeight=this.rowHeight;for(let i=0;i<t.length;i++){this.headerHeight=Math.max(this.headerHeight,t[i].offsetHeight)}}this.pageHeight=this.grid.clientHeight-this.headerHeight;this.pageSize=Math.max(Math.floor(this.pageHeight/this.rowHeight),2)-1;const i=this.totalRows*this.rowHeight;this.isScrollBarShowing=i>this.pageHeight;if(this.isScrollBarShowing){this.scrollContainer.firstElementChild.style.height=`${this.headerHeight+i+(this.smoothScrolling?0:this.rowHeight)}px`;if(this.grid.offsetHeight>this.grid.clientHeight){this.scrollContainer.style.overflowX="scroll"}else{this.scrollContainer.style.overflowX=""}if(this.scrollContainer.clientWidth!==0){this.scrollContainer.style.width=`${this.scrollContainer.offsetWidth-this.scrollContainer.clientWidth}px`}}this.scrollContainer.style.display=this.isScrollBarShowing?"":"none";this.grid.style.overflowY=this.isScrollBarShowing?"scroll":"hidden"}scrollViewport(t){if(this.columns.length>0){const i=this.calculateStartRowAndScrollTop(this.nVisibleRows,t)[1];this.grid.scrollTop=i;const e=Math.round(i-this.grid.scrollTop);if(e){this.logger.warning((()=>`scrollTop has fractional error due to Chrome bug.  Adding ${e} to scrollTop to compensate.`));this.grid.scrollBy(0,e)}}}componentDidRender(){this.setupScrollbar();this.scrollViewport(this.scrollTop);this.logger.debug((()=>`Component did render at x=${this.activeSelectedColumn} y=${this.activeSelectedRow}`));if(this.setFocusAfterRender||this.el.shadowRoot.querySelector(".grid-focusable:focus-within")){this.setFocusOnGrid()}this.setFocusAfterRender=undefined}async toggleOpen(t){const i=this.treeStates.getRow(t+this.startRow);if(i&&!i.isBusy){if(i.isOpen){this.updateTotalRowCount(i.close())}else{await i.open(this.updateTotalRowCount)}}}redraw(t=-1){if(t<0||this.startRow<=t&&t<=this.startRow+this.nVisibleRows){this.refresh()}}commitEditValueChange(t,i,e){const s=t<0?this.activeSelection:this.treeStates.getRow(t+this.startRow);if(s){s.setValue(i,e);this.redraw(t+this.startRow)}}getCommittedEditValue(t,i){const e=t<0?this.activeSelection:this.treeStates.getRow(t+this.startRow);if(e){return e.getValue(i)}}setFocus(){this.cellEditorEnabled=false;this.setFocusOnGrid()}get visibleRowCount(){return this.virtual?this.nVisibleRows:this.pageSize}scrollIntoViewHorizontally(t){const i=this.grid.getBoundingClientRect();const e=this.scrollContainer.getBoundingClientRect();const s=t.getBoundingClientRect();const o=i.left-s.left;const r=s.right-i.right+e.width;if(o>0&&r<0){this.grid.scrollBy(-Math.min(o,-r),0)}else if(o<0&&r>0){this.grid.scrollBy(Math.min(-o,r),0)}}async updateColumnHeadings(){this.editorSelectionState=undefined;const t=this.el.children;const i=[];this.columnHeadings=[];for(let e=0;e<t.length;++e){const s=t[e];if(s.createCellRenderer){this.columnHeadings.push(s);s.setAttribute("slot","columns");i.push(t[e].createCellRenderer(this));s.style.setProperty("z-index",`${t.length-e}`)}}this.columns=await Promise.all(i)}connectedCallback(){this.logger=new n("gc-widget-grid",this.el.id);this.updateColumnHeadings();this.resizeObserver=new ResizeObserver((()=>{this.updateViewportInfo("resize");this.refresh()}));this.resizeObserver.observe(this.el);this.childObserver=new MutationObserver((t=>{t.forEach((t=>{if(t.type==="childList"&&t.target===this.el){this.updateColumnHeadings()}else if(t.type==="attributes"&&t.target!==this.el&&b.has(t.attributeName)){this.refresh()}}))}));this.childObserver.observe(this.el,{attributes:true,childList:true,subtree:true});this.el.addEventListener("css-property-changed",this.onCSSPropertyChanged)}disconnectedCallBack(){this.resizeObserver.disconnect();this.childObserver.disconnect();this.el.removeEventListener("css-property-changed",this.onCSSPropertyChanged)}async setCSSProperty(t,i){i=i.trim();if(await this.getCSSProperty(t)!==i){this.el.style.setProperty(t,i);this.cssPropertyChanged.emit({name:t,value:i})}}async getCSSProperty(t){return getComputedStyle(this.el).getPropertyValue(t).trim()}async refresh(){this._refresh++}get el(){return s(this)}static get watchers(){return{sortByColumn:["onSortByColumnChanged"],sortDescending:["onSortByColumnChanged"],filterText:["onFilterTextChanged"],selectedRow:["onSelectedRowChanged"],selectedPath:["onSelectedPathChanged"],virtual:["onVirtualChanged"]}}};x.style=m;const w=":host{background-color:var(--gc-heading-color, var(--gc-border-color, var(--theme-border-color, #e5e5e5)));font-weight:var(--gc-font-weight, 500);font-size:var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px)));font-style:var(--gc-font-style, normal);white-space:nowrap;margin:0px;position:sticky;top:0%;text-align:var(--gc-heading-text-align, center);width:100%;align-self:stretch;box-sizing:border-box}:host(:focus),:host *:focus{outline:none}.header-container{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:center;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)))}.header-container>*:not(.stretch){flex-shrink:0}.stretch{flex:1}label,gc-widget-label{overflow:hidden;text-overflow:ellipsis;padding:5px 5px 5px 5px}slot::slotted(*:focus),.action:focus{outline:1px dotted var(--gc-focus-color, var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555))));outline-offset:1px}.action{--gc-color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));cursor:pointer}";const y="edit-mode";class k{constructor(t,i){this.params=t;this.callback=i;this.editMode=false;this.onCheckboxKeyHandler=t=>{if(t.key===" "||t.key==="Escape"){t.stopPropagation()}};this.onCheckedValueChangedHandler=t=>{const i=t.currentTarget;this.callback.commitEditValueChange(+i.id,this.params.name,i.checked)};this.onCheckedClickedHandler=t=>{if(this.readonly){t.preventDefault()}};this.onInputBlurHandler=t=>{this.enableEditMode(t.currentTarget,false);this.undoEdit(t.currentTarget)};this.onInputChangedHandler=t=>{let i=t.currentTarget.value;if(this.params.format!=="text"){i=h.convert(i,"string","number");if(isNaN(i)){return this.undoEdit(t.currentTarget)}}this.callback.commitEditValueChange(+t.currentTarget.id,this.params.name,i);this.undoEdit(t.currentTarget,true)};this.onInputKeyHandler=t=>{switch(t.key){case"Escape":this.undoEdit(t.currentTarget);break;case"F2":{this.enableEditMode(t.currentTarget,!this.editMode);t.stopPropagation();break}case" ":t.stopPropagation();break;case"ArrowLeft":case"ArrowRight":case"Home":case"End":if(this.editMode){t.stopPropagation()}break}};this.onInputDoubleClickHandler=t=>{t.currentTarget.select();t.preventDefault()};this.onSelectChangedHandler=t=>{this.callback.commitEditValueChange(-1,this.params.name,t.detail.value)};this.setFocusOnSelect=t=>{var i;const e=t.currentTarget;const s=e.firstElementChild;(i=s===null||s===void 0?void 0:s.setFocus)===null||i===void 0?void 0:i.call(s)};this.onSelectTabIntoHandler=t=>{t.currentTarget.parentElement.focus()}}getDisplayValue(t){var i;if(this.params.format!=="text"){return h.convert(t,typeof t,this.params.format,this.params.precision)||""}return(i=t===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}undoEdit(t,i=false){const e=this.callback.getCommittedEditValue(+t.id,this.params.name);t.value=this.getDisplayValue(e);if(i){t.select()}else{t.setSelectionRange(t.value.length,t.value.length,"none")}}enableEditMode(t,i){if(this.editMode!==i){this.editMode=i;this.params.el.f2EditMode=i;this.params.editModeChanged.emit({value:i});if(this.editMode!==t.classList.contains(y)){if(this.editMode){t.classList.add(y)}else{t.classList.remove(y)}}}}get readonly(){return this.callback.readonly||this.params.readonly}renderCell(t,i,s,o,r){const n=this.params.name;const c=i.getValue(n);const a=this.getDisplayValue(c);const d=c===undefined||this.params.minimized||this.params.hidden;let f=i.getPartName(n);f=f?" "+f:"";const u=this.readonly;let g;if(this.params.format==="boolean"){g=e("input",{type:"checkbox",id:`${t}`,checked:a||false,class:"small",hidden:d,onChange:this.onCheckedValueChangedHandler,onClick:this.onCheckedClickedHandler,tabIndex:r,onKeyDown:this.onCheckboxKeyHandler,part:`checkbox-editor${f}`})}else if(o&&!u&&!d&&this.params.options&&this.params.options.length>0){const t=l.parseArrayProperty(this.params.options);const i=t.map((t=>h.convert(t,typeof t,this.params.format,this.params.precision)));g=e("div",{tabIndex:-1,onFocus:this.setFocusOnSelect},e("gc-widget-select",{"selected-value":c,values:this.params.options,preventEditWhenClosed:true,labels:`${i.join("|")}|`,"onSelected-value-changed":this.onSelectChangedHandler,part:`select-editor${f}`,class:"hiddenWithoutFocus",style:{"--gc-text-align":`${this.params.align}`}}),e("span",{innerHTML:a,class:"hiddenWithFocus",tabIndex:r,onFocus:this.onSelectTabIntoHandler}))}else if(u||this.params.options&&this.params.options.length>0){g=e("span",{hidden:d,innerHTML:a,tabIndex:r,part:f,class:`${o?"selected":""}`})}else{g=e("input",{type:"text",hidden:d,id:`${t}`,value:a,onDblClick:this.onInputDoubleClickHandler,onBlur:this.onInputBlurHandler,onChange:this.onInputChangedHandler,class:`${o?"selected":""}`,onKeyDown:this.onInputKeyHandler,tabIndex:r,part:`input-editor${f}`,readonly:i.isReadOnly(n),style:{margin:"0px","text-align":`${this.params.align}`}})}return{element:g,focusable:!d}}get align(){return this.params.align||"start"}saveEditorSelectionState(t){if(this.readonly){return}if(this.params.format==="boolean"){return}if(this.params.options&&this.params.options.length>0){return}const i=t;return{start:i.selectionStart,end:i.selectionEnd,direction:i.selectionDirection,editMode:this.editMode}}restoreEditorSelectionState(t,i){var e,s,o;if(this.readonly){return}if(this.params.options&&this.params.options.length>0){if(i.hint==="click"||i.hint==="F2"){(e=t.firstElementChild)===null||e===void 0?void 0:e.setState(true)}}else if(this.params.format!=="boolean"){const e=t;if(i.selectAll){e.select()}else if(i.selectionState){(s=e.setSelectionRange)===null||s===void 0?void 0:s.call(e,i.selectionState.start,i.selectionState.end,i.selectionState.direction)}this.enableEditMode(t,i.hint==="F2"||((o=i.selectionState)===null||o===void 0?void 0:o.editMode)||false)}}get hideFocusRectangle(){return!this.readonly&&this.params.format!=="boolean"}getSpan(t,i){return i.getSpan(this.params.name)}}let C=class{constructor(e){t(this,e);this.editModeChanged=i(this,"f2-edit-mode-changed",7);this.minimizedChanged=i(this,"minimized-changed",7);this.cssPropertyChanged=i(this,"css-property-changed",7);this.align="start";this.base=new class extends c{get element(){return this.parent.el}}(this);this.onCssStyleChanged=async()=>{var t,i;const e=(t=await this.getCSSProperty("--gc-text-align"))!==null&&t!==void 0?t:"start";if(e!==this.align&&(e==="start"||e==="center"||e==="end")){this.align=e;(i=this.base.parentGrid)===null||i===void 0?void 0:i.redraw()}};this.format="text";this.readonly=false;this.hideMinimizeAction=false;this.minimized=false;this._refresh=0;this.hidden=false}connectedCallback(){this.onCssStyleChanged();this.el.addEventListener("css-property-changed",this.onCssStyleChanged)}disconnectedCallback(){this.el.removeEventListener("css-property-changed",this.onCssStyleChanged)}async createCellRenderer(t){this.base.parentGrid=t;return new k(this,t)}onColumnPropertyChanged(){var t;(t=this.base.parentGrid)===null||t===void 0?void 0:t.redraw()}onMinimizedChanged(){this.minimizedChanged.emit({value:this.minimized})}componentDidLoad(){this.el.style.setProperty("display","block","important")}render(){return this.base.renderHeader()}async setCSSProperty(t,i){i=i.trim();if(await this.getCSSProperty(t)!==i){this.el.style.setProperty(t,i);this.cssPropertyChanged.emit({name:t,value:i})}}async getCSSProperty(t){return getComputedStyle(this.el).getPropertyValue(t).trim()}async refresh(){this._refresh++}get el(){return s(this)}static get watchers(){return{format:["onColumnPropertyChanged"],precision:["onColumnPropertyChanged"],options:["onColumnPropertyChanged"],readonly:["onColumnPropertyChanged"],hidden:["onColumnPropertyChanged"],hideMinimizeAction:["onColumnPropertyChanged"],minimized:["onColumnPropertyChanged","onMinimizedChanged"]}}};C.style=w;const S=":host{background-color:var(--gc-heading-color, var(--gc-border-color, var(--theme-border-color, #e5e5e5)));font-weight:var(--gc-font-weight, 500);font-size:var(--gc-font-size, var(--gc-font-size, var(--theme-font-size, 14px)));font-style:var(--gc-font-style, normal);white-space:nowrap;margin:0px;position:sticky;top:0%;text-align:var(--gc-heading-text-align, center);width:100%;align-self:stretch;box-sizing:border-box}:host(:focus),:host *:focus{outline:none}.header-container{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:center;color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)))}.header-container>*:not(.stretch){flex-shrink:0}.stretch{flex:1}label,gc-widget-label{overflow:hidden;text-overflow:ellipsis;padding:5px 5px 5px 5px}slot::slotted(*:focus),.action:focus{outline:1px dotted var(--gc-focus-color, var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555))));outline-offset:1px}.action{--gc-color:var(--gc-font-color, var(--gc-font-color, var(--theme-font-color, #555555)));cursor:pointer}";class z{constructor(t,i){this.params=t;this.parentTree=i;this.iconFolderPath=o("../assets/icons/");this.onClickHandler=t=>{this.parentTree.toggleOpen(+t.currentTarget.id)};this.onInfoClickHandler=t=>{this.params.infoIconClicked.emit({row:+t.currentTarget.id})};this.onKeyHandler=t=>{if(t.key===" "||t.key==="Enter"){this.parentTree.toggleOpen(+t.currentTarget.id)}else if(t.key==="Escape"){t.stopPropagation()}else if(t.key==="F1"&&this.params.showInfoIcon){t.stopPropagation();this.onInfoClickHandler(t)}}}renderCell(t,i,s,o,r){const n=`tree${t}`;const h="chevron_right";const l=`${this.iconFolderPath}filled/navigation.svg#${h}`;let c;const a=i.rowIcon;if(a){const t=a.split(":");if(t.length===3){c=`${this.iconFolderPath}${t[0]}/${t[1]}.svg#${t[2]}`}else if(t.length===2){c=`${this.iconFolderPath}filled/${t[0]}.svg#${t[1]}`}}const d=this.params.minimized||this.params.hidden;let f;if(this.params.showInfoIcon){f=`${this.iconFolderPath}filled/action.svg#help_outline`}const u=e("span",{key:n,id:`${t}`,hidden:d,style:{padding:"0px 2px 0px 3px"},class:"flex-row",tabIndex:r,onKeyDown:this.onKeyHandler},e("span",{style:{width:this.getPadding(i),display:"inline-block"}}),e("svg",{role:"img",class:"icon",id:`${t}`,onClick:this.onClickHandler,style:{transform:this.getTranslation(i),visibility:i.isExpandable?"":"hidden"}},e("use",{xlinkHref:l})),i.isBusy?e("div",{class:"progress"}):null,e("label",{key:n+"label",id:`${t}`,class:"flex",part:this.getPart(i),onDblClick:this.onClickHandler},c?e("svg",{role:"img",class:"icon tree"},e("use",{xlinkHref:c})):null,(i===null||i===void 0?void 0:i.getValue(this.params.name||"name"))||"",f?e("svg",{role:"img",id:`${t}`,class:"icon info",onClick:this.onInfoClickHandler,style:{display:i.isExpandable?"none":""}},e("use",{xlinkHref:f})):null));return{element:u,focusable:!d}}getPadding(t){return`${((t===null||t===void 0?void 0:t.indent)||0)*20}px`}getTranslation(t){return`${(t===null||t===void 0?void 0:t.isOpen)?"rotate(90deg)":""}`}getPart(t){return`${(t===null||t===void 0?void 0:t.isOpen)?"open branch":(t===null||t===void 0?void 0:t.isExpandable)?"closed branch":"leaf"}`}getSpan(t,i){var e;return((e=i.getSpan)===null||e===void 0?void 0:e.call(i,this.params.name))||1}}let $=class{constructor(e){t(this,e);this.infoIconClicked=i(this,"info-icon-clicked",7);this.minimizedChanged=i(this,"minimized-changed",7);this.cssPropertyChanged=i(this,"css-property-changed",7);this.base=new class extends c{get element(){return this.parent.el}}(this);this.showInfoIcon=false;this.hideMinimizeAction=false;this.minimized=false;this._refresh=0;this.hidden=false}async createCellRenderer(t){this.base.parentGrid=t;return new z(this,t)}onColumnPropertyChanged(){var t;(t=this.base.parentGrid)===null||t===void 0?void 0:t.redraw()}onMinimizedChanged(){this.minimizedChanged.emit({value:this.minimized})}componentDidLoad(){this.el.style.setProperty("display","block","important")}render(){return this.base.renderHeader()}async setCSSProperty(t,i){i=i.trim();if(await this.getCSSProperty(t)!==i){this.el.style.setProperty(t,i);this.cssPropertyChanged.emit({name:t,value:i})}}async getCSSProperty(t){return getComputedStyle(this.el).getPropertyValue(t).trim()}async refresh(){this._refresh++}get el(){return s(this)}static get watchers(){return{showInfoIcon:["onColumnPropertyChanged"],hidden:["onColumnPropertyChanged"],hideMinimizeAction:["onColumnPropertyChanged"],minimized:["onColumnPropertyChanged","onMinimizedChanged"]}}};$.style=S;export{x as gc_widget_grid,C as gc_widget_grid_data_column,$ as gc_widget_grid_tree_column};
//# sourceMappingURL=p-35d16a17.entry.js.map
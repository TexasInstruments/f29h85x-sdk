<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<title>F29H85x-SDK: HSM client</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="F29H85x-SDK"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">F29H85x-SDK
   &#160;<span id="projectnumber">1.00.00.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <img id="MSearchSelect" src="search/mag.svg" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('DRIVERS_HSMCLIENT_PAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">HSM client </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md194">Introduction</a></li>
<li class="level1"><a href="#autotoc_md195">HSM Client message format.</a><ul><ul><li class="level3"><a href="#autotoc_md196">Message structure description.</a></li>
</ul>
</ul>
</li>
<li class="level1"><a href="#autotoc_md197">HSM client Initialization.</a></li>
<li class="level1"><a href="#autotoc_md198">HSM Client generic service flow.</a></li>
<li class="level1"><a href="#autotoc_md199">HSM Client Load TIFS-MCU API and BootNotify message.</a></li>
<li class="level1"><a href="#DRIVERS_HSMCLIENT_GET_VERSION">HSM Client GetVersion Service.</a><ul><ul><li class="level3"><a href="#autotoc_md200">Example Usage</a></li>
</ul>
</ul>
</li>
<li class="level1"><a href="#DRIVERS_HSMCLIENT_GET_UID">HSM Client GetUID Service.</a><ul><ul><li class="level3"><a href="#autotoc_md201">Example Usage</a></li>
</ul>
</ul>
</li>
<li class="level1"><a href="#DRIVERS_HSMCLIENT_OPEN_DEBUG_FIREWALL">HSM Client Open Debug Firewall Service.</a></li>
<li class="level1"><a href="#DRIVERS_HSMCLIENT_GET_KEK">HSM Client Get Derived KEK Service.</a></li>
<li class="level1"><a href="#DRIVERS_HSMCLIENT_KEYWRITER">HSM Client Key Writer Service.</a></li>
<li class="level1"><a href="#DRIVERS_HSMCLIENT_getRandomNum">HSM Client Get Random Number Service.</a></li>
<li class="level1"><a href="#autotoc_md202">APIs</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_components_drivers_hsmclient"></a></p>
<dl class="section note"><dt>Note</dt><dd>In the following document and in <b>TIFS-MCU</b> document the term used to refer to the Firmware which runs on HSM core is <b>TIFS-MCU Firmware</b>. Please note that the terms 1.**HSMRt Firmware** and 2.**HSMRt** are synonymous to <b>TIFS-MCU Firmware</b>.</dd></dl>
<h1><a class="anchor" id="autotoc_md194"></a>
Introduction</h1>
<ul>
<li>The objective of HSM client is to provide APIs for accessing HSM services. Below given model explains the use of HSM client graphically. It uses <a class="el" href="DRIVERS_SIPC_NOTIFY_PAGE.html">SIPC Notify</a> driver as a low level message passing mechanism to talk to HSM M4 core. HSM client APIs can be used with either <b>FreeRTOS</b> or <b>noRTOS</b> application.</li>
<li>The&#160;HSM Server&#160;provides APIs that will read the incoming request in the form of SIPC message and provide appropriate service based on it. The application which uses HSM server is also known as&#160;TIFS-MCU (HSM runtime firmware).&#160;</li>
</ul>
<p> <style>div.image img[src="sipc_communication_model.png"]{width:30%}</style> </p><div class="image">
<img src="sipc_communication_model.png" alt=""/>
<div class="caption">
HSM CLIENT communication model</div></div>
<ul>
<li>Along side providing services at runtime <b>TIFS-MCU</b> also enables <b>secure boot flow</b>. It is responsible for authenticating&#160;C29 application images&#160;and sends a notification to flash kernel if it is a valid app image , later HSM will program the C29 applications to respective flash memories.</li>
<li>The trusted C29 cores which can communicate with HSM are known as <b>Secure hosts</b>.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>All the services described in the page below apart from HSM Client Key Writer Service are valid only for HS-FS device states.</dd></dl>
<ul>
<li><b>Following services are supported in f29h85x-sdk_1_00_00_00</b><ul>
<li><b>BootNotify Service</b> -: A special message sent by TIFS-MCU Firmware to indicate <b>C29 Application</b> that <b>TIFS-MCU boot</b> was successful.</li>
<li><b>GetVersion Service</b> -: Get The current version of TIFS-MCU Firmware.</li>
<li><b>GetUID Service</b> -: Get the unique ID of the device.</li>
<li><b>Debug Service</b> -: For HS-SE device only. By default debug port for all C29 and HSM is closed. Secure C29s can request debug port access via runtime <b>Debug services</b>.</li>
<li><b>Get DKEK Service</b> -: For HS-SE device only. Get Derived KEK.</li>
<li><b>Get Random Number Service</b> -: Get the random number as generated by TRNG engine.</li>
<li><b>Key Writer Service</b> -: For converting device from HSFS to HSKP.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md195"></a>
HSM Client message format.</h1>
<ul>
<li>Which public cores are going to be <b>secure hosts</b> will be decided by sysconfig configurations of <b>TIFS-MCU</b> at compile time and user has to make sure that similar configurations is done on the C29 side as well.</li>
<li>Below mentioned is the Message structure defined by <a class="el" href="DRIVERS_SIPC_NOTIFY_PAGE.html">SIPC Notify</a> driver. HSM client populates a SIPC message with relevant parameters and sends this message to HSM Server.</li>
</ul>
<p> <style>div.image img[src="sipc_message_ex.png"]{width:40%}</style> </p><div class="image">
<img src="sipc_message_ex.png" alt=""/>
<div class="caption">
SIPC message structure</div></div>
<h3><a class="anchor" id="autotoc_md196"></a>
Message structure description.</h3>
<ul>
<li><b>DestClientID</b> -: Client Id to which a message is going to be sent. In case of C29 -&gt; HSM ( C29 send message to HSM ) this field will always be <b>equal to 1</b> because TIFS-MCU is a NORTOS application and only one client is required.</li>
<li><b>SrcClientID</b> -: Client Id from which a message is going to be sent. In case of HSM -&gt; C29( HSM send message to C29 ) this field will always be equal to 1.</li>
<li><b>flags</b> -: Used for ACK and NACK response signals based on weather a request has been processed correctly or not.<ul>
<li>Client side signals 1. <b>AOP</b> -&gt; ACK on process 2. <b>NOP</b> -&gt; No ACK on process</li>
<li>Server side signals 1. <b>ACK</b> -&gt; request processed successfully 2. <b>NACK</b> -&gt; request process failure.</li>
</ul>
</li>
<li><b>Service_type</b> -: Type of a requested service.</li>
<li><b>Pointer_to_args</b> -: Pointer to the arguments required by a particular service.</li>
<li><b>CRC16(args)</b> -: CRC16 to check the integrity of arguments.</li>
<li><b>CRC16(msg)</b> -: CRC16 to check the integrity of message.</li>
<li>The argument will reside in <b>LDAx</b> and only its pointer is going to be passed in the message itself. When HSM receive the message it reads the argument content from LDAx RAM and process it. Thus other information needed by HSM server can be passed along with the message through HSM MBOX. <dl class="section note"><dt>Note</dt><dd>It is strongly suggested that user application must cleary define a boundary between secure C29 CPU and non secure C29 CPU core's LDAx RAM memory so that non secure core cannot access the parameters of HSM message.</dd></dl>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md197"></a>
HSM client Initialization.</h1>
<ul>
<li>User needs to add an instance of HSM client in <b>Secure C29's</b> sysconfig configuration.</li>
<li>Select the <b>Secure_host_id</b> for the current <b>secure C29</b> core. <dl class="section note"><dt>Note</dt><dd>Make sure that <b>SIPC Message Queue Depth, Number of secure Hosts</b> fields are configured same as in <b>HSM Server's</b> sysconfig.</dd></dl>
 <style>div.image img[src="hsmclient_syscfg.png"]{width:30%}</style> <div class="image">
<img src="hsmclient_syscfg.png" alt=""/>
<div class="caption">
HSM Client sysconfig</div></div>
</li>
<li>Based on the selected configuration <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga3b55ad3229c657ca509f9b29451e37e5">HsmClient_init()</a> will be called during <b>system_init()</b>. <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga3b55ad3229c657ca509f9b29451e37e5" title="Initialize the HSM client for current core.">HsmClient_init()</a> will set the necessary meta data and calls <b>SIPC_init()</b> function.</li>
<li>Refer to sysconfig generated file <b>ti_drivers_config.c</b> for more details.</li>
<li>After initialization user needs to instantiate <a class="el" href="structHsmClient__t.html" title="This is a HSMClient type which holds the information needed by hsm client to communicate with HSM .">HsmClient_t</a> and use <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga152f4adbca2128ca988769beca7009aa" title="register a client to a particular ClientId">HsmClient_register()</a> to register a client with a unique client Id.</li>
<li>There can be at max <b>2</b> distinct registered clients at a time. If user tries to register any more clients <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga152f4adbca2128ca988769beca7009aa" title="register a client to a particular ClientId">HsmClient_register()</a> api will return Failure.</li>
<li>The idea here is that every <b>C29 Core</b> has to register a <b>unique</b> <b>client</b> <b>Id</b> to request services from HSM Server.</li>
<li><dl class="section note"><dt>Note</dt><dd>If user is not using sysconfig then it is important to call <b><a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga3b55ad3229c657ca509f9b29451e37e5" title="Initialize the HSM client for current core.">HsmClient_init()</a></b> with appropriate SIPC_Params before any service function calls.</dd></dl>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md198"></a>
HSM Client generic service flow.</h1>
<ul>
<li>Below mentioned are the generic steps that every service request made by HSM client follows except <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga65e1efbec7ecc3f8a2c27e8a26b9ead0">HSM_MSG_BOOT_NOTIFY</a></li>
</ul>
<p> <style>div.image img[src=" hsmclient_generic_msg.png"]{width:35% }</style> </p><div class="image">
<img src="hsmclient_generic_msg.png" alt=""/>
<div class="caption">
HSM Client generic service flow</div></div>
<ul>
<li>First instantiate <a class="el" href="structHsmClient__t.html" title="This is a HSMClient type which holds the information needed by hsm client to communicate with HSM .">HsmClient_t</a> and register this client object using <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga152f4adbca2128ca988769beca7009aa" title="register a client to a particular ClientId">HsmClient_register()</a>.</li>
<li>populate <b>ReqMsg</b> field of <a class="el" href="structHsmClient__t.html" title="This is a HSMClient type which holds the information needed by hsm client to communicate with HSM .">HsmClient_t</a> with appropriate paramters.<ul>
<li>ReqMsg → destClientId = 0</li>
<li>ReqMsg → srcClientId = current client ID.</li>
<li>ReqMsg → serType = supported service MACRO.</li>
<li>ReqMsg → flags = AOP if ack is expected otherwise NAOP</li>
<li>ReqMsg → args = pointer to message structure based on service type.</li>
<li>ReqMsg → crcArgs = crc of args which is in OCRAM</li>
<li>ReqMsg → crcMsg = crc of the ReqMsg without crcMsg field.</li>
</ul>
</li>
<li>Use SIPC_sendMsg() Api to send the 13 byte message to HSM.</li>
<li>If <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga0842e3d812796be34207849e8dc8dc3a">HSM_FLAG_AOP</a> flag is selected then pend on <a class="el" href="structHsmClient__t.html#a7cd9b04785e82bb2cee46684529ed624">HsmClient_t::Semaphore</a> till timeout exception occurs or a Response message is received. If <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga5f0c48b13ab8d657a61ff359466f16e8">HSM_FLAG_NAOP</a> flag is passed then server will not respond with message.</li>
<li><a class="el" href="hsmclient_8c.html#a0bd2778df320fe0eebb2b0b09db8384f">HsmClient_isr()</a> will receive the response message and copy the same in to <a class="el" href="structHsmClient__t.html#ad1d591cabaa37b805d043bbc96b76efe">HsmClient_t::RespMsg</a> and post the semaphore. As this ISR is blocking we want to quickly read the message and exit it.</li>
<li>check RespMsg integrity i.e CRC16 for HSM message and CRC16 for args. if integrity check fails then return SystemP_FAILURE.</li>
<li>If HSM_FLAG_ACK is received then returns SystemP_SUCCESS else SystemP_FAILURE.</li>
</ul>
<h1><a class="anchor" id="autotoc_md199"></a>
HSM Client Load TIFS-MCU API and BootNotify message.</h1>
<ul>
<li>HSM client Module is used by <b>Flash Kernel</b> to program <b>TIFS-MCU Fiwmware</b> on HSM core.</li>
<li><b>C29 Application</b> instantiates HSM client Module via sysconfig and calls HsmClient_loadHSMRtFirmware() which will load the TIFS-MCU Firmware.</li>
<li>After loading TIFS-MCU Firmware <b>C29 Application</b> application will wait for a <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga65e1efbec7ecc3f8a2c27e8a26b9ead0">HSM_MSG_BOOT_NOTIFY</a> message from HSM server. This messages indicates that TIFS-MCU load is successfull and HSM Server is now ready to take requests from <b>Secure C29</b> cores.</li>
<li>SBL will call <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#gaead2ef4c3b6ee91e2a0a8789fa33e79a" title="Current core will wait for bootnotify message from HSM core.">HsmClient_waitForBootNotify()</a> API which waits till it receives <b>BootNotify</b> message.</li>
<li>Similarly on the HSM side once the <b>TIFS-MCU</b> initialization sequence completes it calls <b>HsmServer_sendBootNotify()</b> API to send a <b>BootNotify</b> message.</li>
<li>Boot Notify sequence Flow chart.</li>
</ul>
<p> <style>div.image img[src="BootNotifyFlow.png"]{width:50%}</style> </p><div class="image">
<img src="BootNotifyFlow.png" alt=""/>
<div class="caption">
Boot Notify sequence Flow chart</div></div>
<ul>
<li><a class="el" href="group__DRV__HSMCLIENT__MODULE.html#gaead2ef4c3b6ee91e2a0a8789fa33e79a" title="Current core will wait for bootnotify message from HSM core.">HsmClient_waitForBootNotify()</a> API takes two parameters one of them is <b>timeToWaitInTicks</b>, This parameter defines how long SBL will wait for HSM_MSG_BOOT_NOTIFY message .User can change this parameter in SBL source code as per need. <dl class="section note"><dt>Note</dt><dd>Currently the <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#gaead2ef4c3b6ee91e2a0a8789fa33e79a" title="Current core will wait for bootnotify message from HSM core.">HsmClient_waitForBootNotify()</a>'s <b>timeToWaitInTicks</b> paramter is set to SystemP_WAIT_FOREVER i.e C29 application will keep waiting for HSM_MSG_BOOT_NOTIFY message indefinitely.</dd></dl>
</li>
<li>refer BOOTFLOW_GUIDE for more information on SBL(Secondary Boot loader)</li>
</ul>
<h1><a class="anchor" id="DRIVERS_HSMCLIENT_GET_VERSION"></a>
HSM Client GetVersion Service.</h1>
<ul>
<li>This service is used to get the current version of <b>TIFS-MCU</b> <b>Firmware</b> running on HSM core.</li>
<li>User needs to instantiate HsmVer_t object and call <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga70b2b53821f5782e083984e34df972b7" title="populates the current HSMRT version Id by default the hsm flag is set to HSM_FLAG_AOP for this servic...">HsmClient_getVersion()</a> API to get the current TIFS-MCU's version.</li>
<li>Refer to <a class="el" href="unionHsmVer__t__.html" title="type for reading HSMRt version.">HsmVer_t_</a> for the description of different fields that defines a unique TIFS-MCU Firmware version. If User needs to know just the unique 64 bit version ID then, user should read <a class="el" href="unionHsmVer__t__.html#a8c5ddfe5a8c5a319511da15173f1bddf">HsmVer_t_::HsmrtVer</a> a 64 bit field which combines all the different fields of <a class="el" href="unionHsmVer__t__.html" title="type for reading HSMRt version.">HsmVer_t_</a>.</li>
<li><a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga70b2b53821f5782e083984e34df972b7" title="populates the current HSMRT version Id by default the hsm flag is set to HSM_FLAG_AOP for this servic...">HsmClient_getVersion()</a> API takes <b>timeToWaitInTicks</b> parameter as input which dictates how long application will wait for the response from HSM core. If the timeout exception occurs <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga70b2b53821f5782e083984e34df972b7" title="populates the current HSMRT version Id by default the hsm flag is set to HSM_FLAG_AOP for this servic...">HsmClient_getVersion()</a> API return SystemP_TIMEOUT.</li>
</ul>
<h3><a class="anchor" id="autotoc_md200"></a>
Example Usage</h3>
<ul>
<li>Please refer to examples provided in TIFS-MCU package.</li>
</ul>
<p> <style>div.image img[src="Get_version.png"]{width:50%}</style> </p><div class="image">
<img src="Get_version.png" alt=""/>
<div class="caption">
Get Version</div></div>
<h1><a class="anchor" id="DRIVERS_HSMCLIENT_GET_UID"></a>
HSM Client GetUID Service.</h1>
<ul>
<li>This service is available <b>HS-SE</b> devices.</li>
<li>This service is used to get UID or Unique ID of the device running TIFS_MCU Firmware.</li>
<li>UID is a 64 byte unique ID for a device which user needs to instantiate as an uint8_t * object and call <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#gad9f5c4c23d11b16ef7ff0eb03a7fa740" title="The service issued to HSM Server populates the Device UID by default the hsm flag is set to HSM_FLAG_...">HsmClient_getUID()</a> API to get the device UID.</li>
</ul>
<h3><a class="anchor" id="autotoc_md201"></a>
Example Usage</h3>
<ul>
<li>Please refer to examples provided in TIFS-MCU package.</li>
</ul>
<p> <style>div.image img[src="Get_uid.png"]{width:50%}</style> </p><div class="image">
<img src="Get_uid.png" alt=""/>
<div class="caption">
Get UID</div></div>
<h1><a class="anchor" id="DRIVERS_HSMCLIENT_OPEN_DEBUG_FIREWALL"></a>
HSM Client Open Debug Firewall Service.</h1>
<ul>
<li>This service is available on <b>HS-SE</b> devices.</li>
<li>The service issued to HSM Server verifies the certificate and by default the hsm flag is set to HSM_FLAG_AOP for this service.</li>
<li>Create certificate with full enable or public enable by using scritpts, send certificate via xmodem. Call <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga3746ff39aab53e9aa4ed690a7dd33b15" title="The service issued to HSM Server verifies the certificate and by default the hsm flag is set to HSM_F...">HsmClient_openDbgFirewall()</a> Api to use debug Services.</li>
</ul>
<p> <style>div.image img[src="debug_auth.png"]{width:50%}</style> </p><div class="image">
<img src="debug_auth.png" alt=""/>
<div class="caption">
Debug authentication</div></div>
<h1><a class="anchor" id="DRIVERS_HSMCLIENT_GET_KEK"></a>
HSM Client Get Derived KEK Service.</h1>
<ul>
<li>This service is available on <b>HS-SE</b> devices.</li>
<li>The service issued to HSM Server retrieves the derived KEK based on identifier as param.</li>
<li>User needs to instantiate <a class="el" href="structDKEK__t.html" title="This is DKEK type which holds the label and context for derivation. This also holds the 256 derived K...">DKEK_t</a> object and call <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga167cf5d7571ab15f4350e744c9e88ed1" title="The service issued to HSM Server retrieves the derived KEK based on identifier as param.">HsmClient_getDKEK()</a> API to get KEK.</li>
</ul>
<p> <style>div.image img[src="DKEK.png"]{width:50%}</style> </p><div class="image">
<img src="DKEK.png" alt=""/>
<div class="caption">
DKEK service</div></div>
<h1><a class="anchor" id="DRIVERS_HSMCLIENT_KEYWRITER"></a>
HSM Client Key Writer Service.</h1>
<ul>
<li>This service is available on <b>HS-FS</b> devices.</li>
<li>The service issued to HSM Server to transition device from HSFS to HSSE.</li>
<li>User needs to instantiate certificate and call <a class="el" href="group__DRV__HSMCLIENT__MODULE.html#ga71bef66d729437b542a5178e1bf24a11" title="The service issued to HSM Server verifies the certificate and process the keywriter operations,...">HsmClient_keyWriter()</a> API to convert device from HSFS to HSKP.</li>
</ul>
<h1><a class="anchor" id="DRIVERS_HSMCLIENT_getRandomNum"></a>
HSM Client Get Random Number Service.</h1>
<ul>
<li>This service is used to generate random number.</li>
<li>User needs to instantiate <a class="el" href="structRNGReq__t.html" title="This is RNG type which holds the resultPtr for derivation which is returned by TIFS....">RNGReq_t</a> object and populate resultLengthPtr, give inputs for DRBG Mode. Along with this the user needs to give seedValue and seedSize in words when DRBG Mode is enabled.</li>
<li>Once the request is processed, HSM populates <code>resultPtr</code>. Depending on the inputs given by the user the desired length the resultPtr stores the random number For example if a getRandomNum request is sent without DRBG Mode and desired length as 32 then the resultPtr stores eight 4 bytes random number without seedValue and seedSize inputs. However there are certain checks over the inputs given by the user for example the desired length should be less than equal to 128 and should be a multiple of 16. The seedSize should be less than or equal to 12 and right inputs for enabling and disabling should be given.</li>
<li>The status of HsmClient_getRandomNum will return SystemP_SUCCESS only when all parameters requested were configured by HSM.</li>
<li>Example getRandomNum output <div class="image">
<img src="RNG.png" alt=""/>
<div class="caption">
Demo Get Random Number log</div></div>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md202"></a>
APIs</h1>
<dl class="section note"><dt>Note</dt><dd>Please note that all the service APIs descried below are not supported in this release</dd></dl>
<p><a class="el" href="group__DRV__HSMCLIENT__MODULE.html">APIs for HSMCLIENT</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
